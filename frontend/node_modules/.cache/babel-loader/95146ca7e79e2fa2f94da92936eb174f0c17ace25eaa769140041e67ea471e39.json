{"ast":null,"code":"import _objectSpread from\"C:/Users/saksh/OneDrive/Desktop/DS/civiceye/civiceye/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useCallback,useMemo}from'react';import{useNavigate,Link}from'react-router-dom';import{useAuth}from'../contexts/AuthContext';import axios from'axios';import{LayoutDashboard,AlertCircle,Users,FileText,Clock,CheckCircle,BarChart3,Search,UserX,UserCheck,ArrowRight,User as UserIcon,Loader2}from'lucide-react';import'./AdminAllIssues.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_BASE_URL='http://localhost:3000/api/v1';// List of standard department strings used during initial complaint registration\nconst DEPARTMENTS=[\"Municipal sanitation and public health\",\"Roads and street infrastructure\",\"Street lighting and electrical assets\",\"Water, sewerage, and stormwater\",\"Ward/zone office and central admin\"];// ------------------------------------------------------------------\n// --- Assign/Reassign Button Component ---\nconst AssignButton=_ref=>{let{issue,volunteers,onAssign}=_ref;const[isReassigning,setIsReassigning]=useState(false);const[selectedVolunteer,setSelectedVolunteer]=useState(issue.assignedTo);const[isSaving,setIsSaving]=useState(false);useEffect(()=>{setSelectedVolunteer(issue.assignedTo);},[issue.assignedTo]);const isAssigned=issue.assignedTo&&issue.assignedTo!=='Unassigned';const isSameVolunteer=selectedVolunteer===issue.assignedTo;const handleAssignment=async()=>{if(!selectedVolunteer||selectedVolunteer==='Unassigned'||isSameVolunteer){setIsReassigning(false);return;}setIsSaving(true);try{await axios.put(\"\".concat(API_BASE_URL,\"/complaints/assign/\").concat(issue.id),{assignedTo:selectedVolunteer},{withCredentials:true});onAssign(issue.id,selectedVolunteer);setIsReassigning(false);alert(\"Issue \".concat(issue.id,\" successfully assigned to \").concat(selectedVolunteer,\".\"));}catch(error){var _error$response,_error$response2,_error$response2$data;console.error(\"Assignment failed:\",((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data)||error.message);alert(\"Failed to assign issue: \".concat(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||'Server error.'));setSelectedVolunteer(issue.assignedTo);}finally{setIsSaving(false);}};if(isReassigning){return/*#__PURE__*/_jsxs(\"div\",{className:\"reassign-control-inline\",children:[/*#__PURE__*/_jsxs(\"select\",{value:selectedVolunteer||'Unassigned',onChange:e=>setSelectedVolunteer(e.target.value==='Unassigned'?null:e.target.value),className:\"volunteer-select-admin\",disabled:isSaving,children:[/*#__PURE__*/_jsx(\"option\",{value:\"Unassigned\",children:\"Select Volunteer\"}),volunteers.map(v=>/*#__PURE__*/_jsx(\"option\",{value:v.name,children:v.name},v.id))]}),/*#__PURE__*/_jsxs(\"div\",{className:\"reassign-actions-group\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"action-btn assign-confirm-btn\",onClick:handleAssignment,disabled:isSaving||!selectedVolunteer||selectedVolunteer==='Unassigned'||isSameVolunteer,children:[isSaving?/*#__PURE__*/_jsx(Loader2,{size:14,className:\"spinner\"}):/*#__PURE__*/_jsx(UserCheck,{size:14}),isSaving?'Saving...':'Assign']}),/*#__PURE__*/_jsx(\"button\",{className:\"action-btn assign-cancel-btn\",onClick:()=>{setIsReassigning(false);setSelectedVolunteer(issue.assignedTo);},disabled:isSaving,children:\"Cancel\"})]})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"assigned-display\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"assigned-name-display\",children:issue.assignedTo||'Unassigned'}),/*#__PURE__*/_jsxs(\"button\",{className:\"reassign-btn \".concat(isAssigned?'reassign':'assign'),onClick:()=>setIsReassigning(true),children:[isAssigned?/*#__PURE__*/_jsx(UserX,{size:14}):/*#__PURE__*/_jsx(UserIcon,{size:14}),isAssigned?'Reassign':'Assign']})]});};// ------------------------------------------------------------------\nconst AllIssuesAdmin=()=>{const navigate=useNavigate();const{user,signOut}=useAuth();// --- State for Live Data ---\nconst[allIssues,setAllIssues]=useState([]);const[allVolunteers,setAllVolunteers]=useState([]);// Live volunteers list\nconst[loading,setLoading]=useState(false);const[error,setError]=useState(null);const[searchTerm,setSearchTerm]=useState('');const[authChecked,setAuthChecked]=useState(false);// ----------------------------\nconst handleLogout=()=>{if(window.confirm('Are you sure you want to logout?')){signOut();navigate('/');}};const getUserInitials=name=>{if(!name)return'MJ';return name.split(' ').map(part=>part[0]).join('').toUpperCase();};const mapStatus=serverStatus=>{switch(serverStatus){case'recived':return'Pending';case'inReview':return'In Progress';case'resolved':return'Resolved';default:return'Pending';}};// --- API Fetch Functions ---\nconst fetchVolunteers=useCallback(async()=>{try{// Fetches all users and filters for volunteers\nconst response=await axios.get(\"\".concat(API_BASE_URL,\"/users/list-all\"),{withCredentials:true});const volunteersList=response.data.data.filter(u=>u.role==='volunteer').map(v=>({id:v._id,name:v.name,location:v.location}));setAllVolunteers(volunteersList);}catch(err){console.error(\"Failed to fetch volunteer list:\",err.message);}},[]);const fetchIssues=useCallback(async()=>{setLoading(true);setError(null);try{const response=await axios.get(\"\".concat(API_BASE_URL,\"/complaints/all\"),{withCredentials:true});const mappedIssues=response.data.data.map(comp=>{var _comp$userId;const statusText=mapStatus(comp.status);const mockPriority=['high','medium','low'][Math.floor(Math.random()*3)];let assignedToName=comp.assignedTo;// CRITICAL FIX: If assignedTo is one of the department strings, show it as null/Unassigned.\nif(DEPARTMENTS.includes(assignedToName)){assignedToName=null;}const mockReportedBy=((_comp$userId=comp.userId)===null||_comp$userId===void 0?void 0:_comp$userId.name)||'Anonymous Citizen';return{id:comp._id,title:comp.title,status:statusText.toLowerCase().replace(' ',''),priority:mockPriority,assignedTo:assignedToName,// Name comes directly from DB\nreportedBy:mockReportedBy,date:new Date(comp.createdAt).toLocaleDateString('en-US')};});setAllIssues(mappedIssues);}catch(err){var _err$response;console.error(\"Failed to fetch issues:\",((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.data)||err.message);setError('Failed to fetch issues data.');}finally{setLoading(false);}},[]);// --- Auth Check and Data Fetch Effects ---\nuseEffect(()=>{const checkAuth=setTimeout(()=>{setAuthChecked(true);},50);return()=>clearTimeout(checkAuth);},[]);useEffect(()=>{if(!authChecked)return;if(user){fetchIssues();fetchVolunteers();// Fetch the list of volunteers\n}else{navigate('/login');}},[user,navigate,fetchIssues,fetchVolunteers,authChecked]);// --- Data Aggregation and Filtering ---\nconst filteredIssues=useMemo(()=>{if(!searchTerm)return allIssues;const lowerSearchTerm=searchTerm.toLowerCase();return allIssues.filter(issue=>issue.title.toLowerCase().includes(lowerSearchTerm)||issue.reportedBy.toLowerCase().includes(lowerSearchTerm)||(issue.assignedTo||'').toLowerCase().includes(lowerSearchTerm)||issue.status.toLowerCase().includes(lowerSearchTerm));},[allIssues,searchTerm]);const dynamicStats=useMemo(()=>{const total=allIssues.length;const inProgress=allIssues.filter(i=>i.status==='inprogress').length;const resolved=allIssues.filter(i=>i.status==='resolved').length;const pending=allIssues.filter(i=>i.status==='pending').length;return[{label:'Total Issues',value:total,icon:BarChart3,color:'#e5e7eb'},{label:'In Progress',value:inProgress,icon:Clock,color:'#dbeafe'},{label:'Resolved',value:resolved,icon:CheckCircle,color:'#dcfce7'},{label:'Pending',value:pending,icon:AlertCircle,color:'#ffedd5'}];},[allIssues]);// --- Assignment Logic ---\nconst handleAssignIssue=(issueId,newVolunteerName)=>{setAllIssues(prevIssues=>prevIssues.map(issue=>issue.id===issueId?_objectSpread(_objectSpread({},issue),{},{assignedTo:newVolunteerName}):issue));};// ... (handleViewDetails and conditional rendering remains) ...\nif(!user&&!authChecked){return/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',alignItems:'center',height:'100vh'},children:/*#__PURE__*/_jsx(\"p\",{children:\"Loading user session...\"})});}if(!user)return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"all-issues-admin\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"admin-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"admin-header-left\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"admin-logo\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"admin-logo-text\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"admin-logo-title\",children:\"CivicEye\"}),/*#__PURE__*/_jsx(\"div\",{className:\"admin-logo-subtitle\",children:\"Civic Platform\"})]})}),/*#__PURE__*/_jsxs(\"nav\",{className:\"admin-nav\",children:[/*#__PURE__*/_jsxs(Link,{to:\"/admin-dashboard\",className:\"admin-nav-link\",children:[/*#__PURE__*/_jsx(LayoutDashboard,{size:18}),\" Dashboard\"]}),/*#__PURE__*/_jsxs(Link,{to:\"/admin-all-issues\",className:\"admin-nav-link active\",children:[/*#__PURE__*/_jsx(AlertCircle,{size:18}),\" All Issues\"]}),/*#__PURE__*/_jsxs(Link,{to:\"/admin-users-volunteers\",className:\"admin-nav-link\",children:[/*#__PURE__*/_jsx(Users,{size:18}),\" Users & Volunteers\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-profile\",children:[/*#__PURE__*/_jsxs(Link,{to:\"/AdminProfile\",className:\"profile-link\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"user-initials\",children:getUserInitials(user.name)}),/*#__PURE__*/_jsx(\"span\",{className:\"user-name\",children:user.name})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,className:\"logout-btn-header\",children:/*#__PURE__*/_jsx(ArrowRight,{size:20})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"issues-hero\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"issues-hero-content\",children:[/*#__PURE__*/_jsx(BarChart3,{size:36}),/*#__PURE__*/_jsx(\"h1\",{children:\"All Issues Management\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Comprehensive oversight and management of all reported issues across the platform\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"issues-stats-grid\",children:dynamicStats.map((stat,idx)=>{const Icon=stat.icon;return/*#__PURE__*/_jsx(\"div\",{className:\"issues-stat-card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"issues-stat-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"issues-stat-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"issues-stat-label\",children:stat.label}),/*#__PURE__*/_jsx(\"div\",{className:\"issues-stat-value\",children:stat.value})]}),/*#__PURE__*/_jsx(\"div\",{className:\"issues-stat-icon\",style:{backgroundColor:stat.color},children:/*#__PURE__*/_jsx(Icon,{size:24,color:\"#6b7280\"})})]})},idx);})}),/*#__PURE__*/_jsxs(\"div\",{className:\"issues-table-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"issues-table-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"issues-table-title\",children:[/*#__PURE__*/_jsx(AlertCircle,{size:20}),/*#__PURE__*/_jsx(\"h2\",{children:\"Issues Overview\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"issues-table-subtitle\",children:\"Complete list of all reported issues with management actions\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"table-actions\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"search-box\",children:[/*#__PURE__*/_jsx(Search,{size:18}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search issues...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value)})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"issues-table-container\",children:loading?/*#__PURE__*/_jsxs(\"div\",{className:\"loading-state-admin\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading issues from database...\"})]}):error?/*#__PURE__*/_jsxs(\"div\",{className:\"error-state-admin\",children:[/*#__PURE__*/_jsx(AlertCircle,{size:24,color:\"#ef4444\"}),/*#__PURE__*/_jsx(\"p\",{children:error})]}):filteredIssues.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state-admin\",children:[/*#__PURE__*/_jsx(Search,{size:24,color:\"#9ca3af\"}),/*#__PURE__*/_jsx(\"p\",{children:\"No issues found matching your search criteria.\"})]}):/*#__PURE__*/_jsxs(\"table\",{className:\"issues-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Title\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Priority\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Assigned To\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Reported By\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Date\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:filteredIssues.map(issue=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"issue-title-cell\",children:issue.title}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"span\",{className:\"status-badge status-\".concat(issue.status),children:issue.status})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"span\",{className:\"priority-badge priority-\".concat(issue.priority),children:issue.priority})}),/*#__PURE__*/_jsx(\"td\",{className:\"assigned-cell-combined\",children:/*#__PURE__*/_jsx(AssignButton,{issue:issue,volunteers:allVolunteers,onAssign:handleAssignIssue})}),/*#__PURE__*/_jsx(\"td\",{children:issue.reportedBy}),/*#__PURE__*/_jsx(\"td\",{children:issue.date})]},issue.id))})]})})]})]});};export default AllIssuesAdmin;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useMemo","useNavigate","Link","useAuth","axios","LayoutDashboard","AlertCircle","Users","FileText","Clock","CheckCircle","BarChart3","Search","UserX","UserCheck","ArrowRight","User","UserIcon","Loader2","jsx","_jsx","jsxs","_jsxs","API_BASE_URL","DEPARTMENTS","AssignButton","_ref","issue","volunteers","onAssign","isReassigning","setIsReassigning","selectedVolunteer","setSelectedVolunteer","assignedTo","isSaving","setIsSaving","isAssigned","isSameVolunteer","handleAssignment","put","concat","id","withCredentials","alert","error","_error$response","_error$response2","_error$response2$data","console","response","data","message","className","children","value","onChange","e","target","disabled","map","v","name","onClick","size","AllIssuesAdmin","navigate","user","signOut","allIssues","setAllIssues","allVolunteers","setAllVolunteers","loading","setLoading","setError","searchTerm","setSearchTerm","authChecked","setAuthChecked","handleLogout","window","confirm","getUserInitials","split","part","join","toUpperCase","mapStatus","serverStatus","fetchVolunteers","get","volunteersList","filter","u","role","_id","location","err","fetchIssues","mappedIssues","comp","_comp$userId","statusText","status","mockPriority","Math","floor","random","assignedToName","includes","mockReportedBy","userId","title","toLowerCase","replace","priority","reportedBy","date","Date","createdAt","toLocaleDateString","_err$response","checkAuth","setTimeout","clearTimeout","filteredIssues","lowerSearchTerm","dynamicStats","total","length","inProgress","i","resolved","pending","label","icon","color","handleAssignIssue","issueId","newVolunteerName","prevIssues","_objectSpread","style","display","justifyContent","alignItems","height","to","stat","idx","Icon","backgroundColor","type","placeholder"],"sources":["C:/Users/saksh/OneDrive/Desktop/DS/civiceye/civiceye/frontend/src/pages/AdminAllIssues.js"],"sourcesContent":["import React, { useState, useEffect, useCallback, useMemo } from 'react';\r\nimport { useNavigate, Link } from 'react-router-dom';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport axios from 'axios';\r\nimport { \r\n    LayoutDashboard, AlertCircle, Users, FileText, Clock, \r\n    CheckCircle, BarChart3, Search, UserX, UserCheck,ArrowRight, \r\n    User as UserIcon, Loader2 \r\n} from 'lucide-react';\r\nimport './AdminAllIssues.css';\r\n\r\nconst API_BASE_URL = 'http://localhost:3000/api/v1';\r\n\r\n// List of standard department strings used during initial complaint registration\r\nconst DEPARTMENTS = [\r\n    \"Municipal sanitation and public health\",\r\n    \"Roads and street infrastructure\",\r\n    \"Street lighting and electrical assets\",\r\n    \"Water, sewerage, and stormwater\",\r\n    \"Ward/zone office and central admin\"\r\n];\r\n// ------------------------------------------------------------------\r\n\r\n// --- Assign/Reassign Button Component ---\r\nconst AssignButton = ({ issue, volunteers, onAssign }) => {\r\n    const [isReassigning, setIsReassigning] = useState(false);\r\n    const [selectedVolunteer, setSelectedVolunteer] = useState(issue.assignedTo);\r\n    const [isSaving, setIsSaving] = useState(false);\r\n\r\n    useEffect(() => {\r\n        setSelectedVolunteer(issue.assignedTo);\r\n    }, [issue.assignedTo]);\r\n\r\n    const isAssigned = issue.assignedTo && issue.assignedTo !== 'Unassigned';\r\n    const isSameVolunteer = selectedVolunteer === issue.assignedTo;\r\n\r\n    const handleAssignment = async () => {\r\n        if (!selectedVolunteer || selectedVolunteer === 'Unassigned' || isSameVolunteer) {\r\n            setIsReassigning(false);\r\n            return;\r\n        }\r\n        \r\n        setIsSaving(true);\r\n\r\n        try {\r\n            await axios.put(`${API_BASE_URL}/complaints/assign/${issue.id}`, \r\n                { assignedTo: selectedVolunteer },\r\n                { withCredentials: true }\r\n            );\r\n\r\n            onAssign(issue.id, selectedVolunteer);\r\n\r\n            setIsReassigning(false);\r\n            alert(`Issue ${issue.id} successfully assigned to ${selectedVolunteer}.`);\r\n\r\n        } catch (error) {\r\n            console.error(\"Assignment failed:\", error.response?.data || error.message);\r\n            alert(`Failed to assign issue: ${error.response?.data?.message || 'Server error.'}`);\r\n            \r\n            setSelectedVolunteer(issue.assignedTo); \r\n        } finally {\r\n            setIsSaving(false);\r\n        }\r\n    };\r\n\r\n    if (isReassigning) {\r\n        return (\r\n            <div className=\"reassign-control-inline\">\r\n                <select \r\n                    value={selectedVolunteer || 'Unassigned'} \r\n                    onChange={(e) => setSelectedVolunteer(e.target.value === 'Unassigned' ? null : e.target.value)}\r\n                    className=\"volunteer-select-admin\"\r\n                    disabled={isSaving}\r\n                >\r\n                    <option value=\"Unassigned\">Select Volunteer</option>\r\n                    {/* CRITICAL FIX: Use the live 'volunteers' prop */}\r\n                    {volunteers.map(v => ( \r\n                        <option key={v.id} value={v.name}>{v.name}</option>\r\n                    ))}\r\n                </select>\r\n                <div className=\"reassign-actions-group\">\r\n                    <button \r\n                        className=\"action-btn assign-confirm-btn\"\r\n                        onClick={handleAssignment}\r\n                        disabled={isSaving || !selectedVolunteer || selectedVolunteer === 'Unassigned' || isSameVolunteer}\r\n                    >\r\n                        {isSaving ? <Loader2 size={14} className=\"spinner\" /> : <UserCheck size={14} />}\r\n                        {isSaving ? 'Saving...' : 'Assign'}\r\n                    </button>\r\n                    <button \r\n                        className=\"action-btn assign-cancel-btn\"\r\n                        onClick={() => { \r\n                            setIsReassigning(false); \r\n                            setSelectedVolunteer(issue.assignedTo);\r\n                        }}\r\n                        disabled={isSaving}\r\n                    >\r\n                        Cancel\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"assigned-display\">\r\n            <span className=\"assigned-name-display\">{issue.assignedTo || 'Unassigned'}</span>\r\n            <button \r\n                className={`reassign-btn ${isAssigned ? 'reassign' : 'assign'}`}\r\n                onClick={() => setIsReassigning(true)}\r\n            >\r\n                {isAssigned ? <UserX size={14} /> : <UserIcon size={14} />}\r\n                {isAssigned ? 'Reassign' : 'Assign'}\r\n            </button>\r\n        </div>\r\n    );\r\n};\r\n// ------------------------------------------------------------------\r\n\r\nconst AllIssuesAdmin = () => {\r\n    const navigate = useNavigate();\r\n    const { user, signOut } = useAuth();\r\n    \r\n    // --- State for Live Data ---\r\n    const [allIssues, setAllIssues] = useState([]);\r\n    const [allVolunteers, setAllVolunteers] = useState([]); // Live volunteers list\r\n    const [loading, setLoading] = useState(false);\r\n    const [error, setError] = useState(null);\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n    const [authChecked, setAuthChecked] = useState(false); \r\n    // ----------------------------\r\n\r\n    const handleLogout = () => {\r\n        if (window.confirm('Are you sure you want to logout?')) {\r\n            signOut();\r\n            navigate('/');\r\n        }\r\n    };\r\n\r\n    const getUserInitials = (name) => {\r\n        if (!name) return 'MJ';\r\n        return name.split(' ').map(part => part[0]).join('').toUpperCase();\r\n    };\r\n\r\n    const mapStatus = (serverStatus) => {\r\n        switch (serverStatus) {\r\n            case 'recived': return 'Pending';\r\n            case 'inReview': return 'In Progress';\r\n            case 'resolved': return 'Resolved';\r\n            default: return 'Pending';\r\n        }\r\n    };\r\n    \r\n    // --- API Fetch Functions ---\r\n    const fetchVolunteers = useCallback(async () => {\r\n        try {\r\n            // Fetches all users and filters for volunteers\r\n            const response = await axios.get(`${API_BASE_URL}/users/list-all`, { withCredentials: true });\r\n            const volunteersList = response.data.data.filter(u => u.role === 'volunteer').map(v => ({\r\n                id: v._id,\r\n                name: v.name,\r\n                location: v.location \r\n            }));\r\n            setAllVolunteers(volunteersList);\r\n        } catch (err) {\r\n            console.error(\"Failed to fetch volunteer list:\", err.message);\r\n        }\r\n    }, []);\r\n\r\n\r\n    const fetchIssues = useCallback(async () => {\r\n        setLoading(true);\r\n        setError(null);\r\n\r\n        try {\r\n            const response = await axios.get(`${API_BASE_URL}/complaints/all`, {\r\n                withCredentials: true\r\n            });\r\n            \r\n            const mappedIssues = response.data.data.map(comp => {\r\n                const statusText = mapStatus(comp.status);\r\n                const mockPriority = ['high', 'medium', 'low'][Math.floor(Math.random() * 3)];\r\n                \r\n                let assignedToName = comp.assignedTo; \r\n                \r\n                // CRITICAL FIX: If assignedTo is one of the department strings, show it as null/Unassigned.\r\n                if (DEPARTMENTS.includes(assignedToName)) {\r\n                    assignedToName = null; \r\n                }\r\n\r\n                const mockReportedBy = comp.userId?.name || 'Anonymous Citizen'; \r\n\r\n                return {\r\n                    id: comp._id,\r\n                    title: comp.title,\r\n                    status: statusText.toLowerCase().replace(' ', ''), \r\n                    priority: mockPriority, \r\n                    assignedTo: assignedToName, // Name comes directly from DB\r\n                    reportedBy: mockReportedBy,\r\n                    date: new Date(comp.createdAt).toLocaleDateString('en-US'),\r\n                };\r\n            });\r\n\r\n            setAllIssues(mappedIssues);\r\n        } catch (err) {\r\n            console.error(\"Failed to fetch issues:\", err.response?.data || err.message);\r\n            setError('Failed to fetch issues data.');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }, []); \r\n\r\n    // --- Auth Check and Data Fetch Effects ---\r\n    useEffect(() => {\r\n        const checkAuth = setTimeout(() => { setAuthChecked(true); }, 50); \r\n        return () => clearTimeout(checkAuth);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (!authChecked) return;\r\n        if (user) {\r\n            fetchIssues();\r\n            fetchVolunteers(); // Fetch the list of volunteers\r\n        } else {\r\n            navigate('/login');\r\n        }\r\n    }, [user, navigate, fetchIssues, fetchVolunteers, authChecked]);\r\n\r\n\r\n    // --- Data Aggregation and Filtering ---\r\n    const filteredIssues = useMemo(() => {\r\n        if (!searchTerm) return allIssues;\r\n        const lowerSearchTerm = searchTerm.toLowerCase();\r\n        return allIssues.filter(issue => \r\n            issue.title.toLowerCase().includes(lowerSearchTerm) ||\r\n            issue.reportedBy.toLowerCase().includes(lowerSearchTerm) ||\r\n            (issue.assignedTo || '').toLowerCase().includes(lowerSearchTerm) ||\r\n            issue.status.toLowerCase().includes(lowerSearchTerm)\r\n        );\r\n    }, [allIssues, searchTerm]);\r\n\r\n    const dynamicStats = useMemo(() => {\r\n        const total = allIssues.length;\r\n        const inProgress = allIssues.filter(i => i.status === 'inprogress').length;\r\n        const resolved = allIssues.filter(i => i.status === 'resolved').length;\r\n        const pending = allIssues.filter(i => i.status === 'pending').length;\r\n\r\n        return [\r\n            { label: 'Total Issues', value: total, icon: BarChart3, color: '#e5e7eb' },\r\n            { label: 'In Progress', value: inProgress, icon: Clock, color: '#dbeafe' },\r\n            { label: 'Resolved', value: resolved, icon: CheckCircle, color: '#dcfce7' },\r\n            { label: 'Pending', value: pending, icon: AlertCircle, color: '#ffedd5' }\r\n        ];\r\n    }, [allIssues]);\r\n\r\n\r\n    // --- Assignment Logic ---\r\n    const handleAssignIssue = (issueId, newVolunteerName) => {\r\n        setAllIssues(prevIssues => prevIssues.map(issue => \r\n            issue.id === issueId ? { ...issue, assignedTo: newVolunteerName } : issue\r\n        ));\r\n    };\r\n    \r\n    // ... (handleViewDetails and conditional rendering remains) ...\r\n    if (!user && !authChecked) {\r\n        return (\r\n            <div style={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: '100vh' }}>\r\n                <p>Loading user session...</p>\r\n            </div>\r\n        );\r\n    }\r\n    \r\n    if (!user) return null;\r\n\r\n    return (\r\n        <div className=\"all-issues-admin\">\r\n            {/* Header */}\r\n            <header className=\"admin-header\">\r\n                <div className=\"admin-header-left\">\r\n                    <div className=\"admin-logo\">\r\n                        \r\n                        <div className=\"admin-logo-text\">\r\n                            <div className=\"admin-logo-title\">CivicEye</div>\r\n                            <div className=\"admin-logo-subtitle\">Civic Platform</div>\r\n                        </div>\r\n                    </div>\r\n                    <nav className=\"admin-nav\">\r\n                        <Link to=\"/admin-dashboard\" className=\"admin-nav-link\">\r\n                            <LayoutDashboard size={18} /> Dashboard\r\n                        </Link>\r\n                        <Link to=\"/admin-all-issues\" className=\"admin-nav-link active\">\r\n                            <AlertCircle size={18} /> All Issues\r\n                        </Link>\r\n                        <Link to=\"/admin-users-volunteers\" className=\"admin-nav-link\">\r\n                            <Users size={18} /> Users & Volunteers\r\n                        </Link>\r\n                        {/* <Link to=\"/admin-requests\" className=\"admin-nav-link\">\r\n                            <FileText size={18} /> Admin Request\r\n                        </Link> */}\r\n                        {/* <Link to=\"/admin-issues-updates\" className=\"admin-nav-link\">\r\n                            <Clock size={18} /> Issue Updates\r\n                        </Link> */}\r\n                    </nav>\r\n                </div>\r\n                <div className=\"user-profile\">\r\n                    <Link to=\"/AdminProfile\" className=\"profile-link\">\r\n                        <div className=\"user-initials\">{getUserInitials(user.name)}</div>\r\n                        <span className=\"user-name\">{user.name}</span>\r\n                    </Link>\r\n                    <button onClick={handleLogout} className=\"logout-btn-header\">\r\n                        <ArrowRight size={20} />\r\n                    </button>\r\n                </div>\r\n            </header>\r\n\r\n            <div className=\"issues-hero\">\r\n                <div className=\"issues-hero-content\">\r\n                    <BarChart3 size={36} />\r\n                    <h1>All Issues Management</h1>\r\n                    <p>Comprehensive oversight and management of all reported issues across the platform</p>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"issues-stats-grid\">\r\n                {dynamicStats.map((stat, idx) => {\r\n                    const Icon = stat.icon;\r\n                    return (\r\n                        <div key={idx} className=\"issues-stat-card\">\r\n                            <div className=\"issues-stat-content\">\r\n                                <div className=\"issues-stat-info\">\r\n                                    <div className=\"issues-stat-label\">{stat.label}</div>\r\n                                    <div className=\"issues-stat-value\">{stat.value}</div>\r\n                                </div>\r\n                                <div className=\"issues-stat-icon\" style={{ backgroundColor: stat.color }}>\r\n                                    <Icon size={24} color=\"#6b7280\" />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    );\r\n                })}\r\n            </div>\r\n\r\n            <div className=\"issues-table-section\">\r\n                <div className=\"issues-table-header\">\r\n                    <div className=\"issues-table-title\">\r\n                        <AlertCircle size={20} />\r\n                        <h2>Issues Overview</h2>\r\n                    </div>\r\n                    <p className=\"issues-table-subtitle\">Complete list of all reported issues with management actions</p>\r\n                </div>\r\n\r\n                <div className=\"table-actions\">\r\n                    <div className=\"search-box\">\r\n                        <Search size={18} />\r\n                        <input \r\n                            type=\"text\" \r\n                            placeholder=\"Search issues...\"\r\n                            value={searchTerm}\r\n                            onChange={(e) => setSearchTerm(e.target.value)}\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"issues-table-container\">\r\n                    {loading ? (\r\n                        <div className=\"loading-state-admin\">\r\n                            <div className=\"loading-spinner\"></div>\r\n                            <p>Loading issues from database...</p>\r\n                        </div>\r\n                    ) : error ? (\r\n                        <div className=\"error-state-admin\">\r\n                            <AlertCircle size={24} color=\"#ef4444\" />\r\n                            <p>{error}</p>\r\n                        </div>\r\n                    ) : filteredIssues.length === 0 ? (\r\n                        <div className=\"empty-state-admin\">\r\n                            <Search size={24} color=\"#9ca3af\" />\r\n                            <p>No issues found matching your search criteria.</p>\r\n                        </div>\r\n                    ) : (\r\n                        <table className=\"issues-table\">\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>Title</th>\r\n                                    <th>Status</th>\r\n                                    <th>Priority</th>\r\n                                    <th>Assigned To</th>\r\n                                    <th>Reported By</th>\r\n                                    <th>Date</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                {filteredIssues.map((issue) => (\r\n                                    <tr key={issue.id}>\r\n                                        <td className=\"issue-title-cell\">{issue.title}</td>\r\n                                        <td>\r\n                                            <span className={`status-badge status-${issue.status}`}>\r\n                                                {issue.status}\r\n                                            </span>\r\n                                        </td>\r\n                                        <td>\r\n                                            <span className={`priority-badge priority-${issue.priority}`}>\r\n                                                {issue.priority}\r\n                                            </span>\r\n                                        </td>\r\n                                        \r\n                                        <td className=\"assigned-cell-combined\">\r\n                                            <AssignButton \r\n                                                issue={issue}\r\n                                                volunteers={allVolunteers}\r\n                                                onAssign={handleAssignIssue}\r\n                                            />\r\n                                        </td>\r\n                                        \r\n                                        <td>{issue.reportedBy}</td>\r\n                                        <td>{issue.date}</td>\r\n                                    </tr>\r\n                                ))}\r\n                            </tbody>\r\n                        </table>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default AllIssuesAdmin;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}