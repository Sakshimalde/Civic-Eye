{"ast":null,"code":"import _objectSpread from\"C:/Users/saksh/OneDrive/Desktop/DS/civiceye/civiceye/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useCallback,useMemo}from'react';import{Link,useNavigate}from'react-router-dom';import axios from'axios';import{useAuth}from'../contexts/AuthContext';import{Search,Filter,MapPin,ArrowRight,BarChart3,Users,FileText,PlusCircle,Heart,MessageSquare,Eye,Clock,ChevronsDown,ThumbsDown,Edit,Save}from'lucide-react';import'./IssuesBrowser.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const API_BASE_URL='http://localhost:3000/api/v1';// Define API URL\n// --- Time utility ---\nconst getRelativeTime=isoDateString=>{const reportDate=new Date(isoDateString);const today=new Date();const startOfToday=new Date(today.getFullYear(),today.getMonth(),today.getDate());const startOfReportDay=new Date(reportDate.getFullYear(),reportDate.getMonth(),reportDate.getDate());const diffTime=startOfToday.getTime()-startOfReportDay.getTime();const diffDays=Math.floor(diffTime/(1000*60*60*24));if(diffDays===0){const hoursDiff=Math.floor((today.getTime()-reportDate.getTime())/(1000*60*60));if(hoursDiff===0)return'Just now';if(hoursDiff<24)return\"\".concat(hoursDiff,\" hours ago\");return'Today';}if(diffDays===1)return'Yesterday';if(diffDays<7)return\"\".concat(diffDays,\" days ago\");if(diffDays<30)return\"\".concat(Math.floor(diffDays/7),\" weeks ago\");return\"\".concat(Math.floor(diffDays/30),\" months ago\");};const getUserInitials=name=>{if(!name)return'JD';const nameParts=name.split(' ');const initials=nameParts.map(part=>part[0]).join('');return initials.toUpperCase();};const UserBrowseIssue=()=>{const{user,signOut}=useAuth();const navigate=useNavigate();const[authChecked,setAuthChecked]=useState(false);const[issues,setIssues]=useState([]);const[filteredIssues,setFilteredIssues]=useState([]);const[loading,setLoading]=useState(false);const[searchTerm,setSearchTerm]=useState('');const[filters,setFilters]=useState({category:'All Categories',status:'All Statuses',sort:'Newest First'});// userVotes state is crucial for persistent coloring\nconst[userVotes,setUserVotes]=useState({});const[commentsOpen,setCommentsOpen]=useState({});const[commentsStore,setCommentsStore]=useState({});const[commentDrafts,setCommentDrafts]=useState({});const[busyComments,setBusyComments]=useState({});// State to manage voting action busy status\nconst[busyVotes,setBusyVotes]=useState({});// Consistent state name\nconst[editingComment,setEditingComment]=useState(null);const categories=useMemo(()=>['All Categories','Garbage & Waste','Potholes','Water Issues','Street Lights','Vandalism','Other'],[]);const statusOptions=useMemo(()=>['All Statuses','Pending','In Progress','Resolved'],[]);const sortOptions=useMemo(()=>['Newest First','Oldest First','Most Voted','Most Viewed','Priority'],[]);const issueCategories=useMemo(()=>[{category:'Garbage & Waste',count:0,icon:'ðŸ—‘ï¸',color:'#E53E3E'},{category:'Potholes',count:0,icon:'ðŸ•³ï¸',color:'#DD6B20'},{category:'Water Issues',count:0,icon:'ðŸ’§',color:'#3182CE'},{category:'Street Lights',count:0,icon:'ðŸ’¡',color:'#D69E2E'},{category:'Vandalism',count:0,icon:'ðŸŽ¨',color:'#805AD5'},{category:'Other',count:0,icon:'ðŸ“‹',color:'#718096'}],[]);const communityImpact={issuesResolved:'89+',responseTime:'2.3 days avg',communityScore:'95%',activeUsers:'1.2k',totalReports:'2.8k'};const fetchIssues=useCallback(async()=>{if(!user)return;setLoading(true);const params={search:searchTerm.trim(),category:filters.category,status:filters.status,sort:filters.sort};try{const response=await axios.get(\"\".concat(API_BASE_URL,\"/complaints/all\"),{params:params,withCredentials:true});const fetchedIssues=response.data.data.map(comp=>{var _comp$address,_comp$userId,_comp$comments;const statusText=comp.status==='recived'?'Pending':comp.status==='inReview'?'In Progress':comp.status==='resolved'?'Resolved':'Pending';const locationText=((_comp$address=comp.address)===null||_comp$address===void 0?void 0:_comp$address[0])||'Unknown Location';const userName=typeof comp.userId==='object'&&(_comp$userId=comp.userId)!==null&&_comp$userId!==void 0&&_comp$userId.name?comp.userId.name:'Anonymous User';const reverseCategoryMap={'Municipal sanitation and public health':'Garbage & Waste','Roads and street infrastructure':'Potholes','Street lighting and electrical assets':'Street Lights','Water, sewerage, and stormwater':'Water Issues','Ward/zone office and central admin':'Vandalism'};const displayCategory=reverseCategoryMap[comp.assignedTo]||'Other';return{id:comp._id,title:comp.title,description:comp.description,location:locationText,category:displayCategory,status:statusText,createdAt:comp.createdAt,votes:0,comments:((_comp$comments=comp.comments)===null||_comp$comments===void 0?void 0:_comp$comments.length)||0,views:Math.floor(Math.random()*200),priority:['high','medium','low'][Math.floor(Math.random()*3)],urgency:'Community Concern',user:userName,userAvatar:getUserInitials(userName),counts:{upvote:0,downVote:0}};});// Fetch user-specific vote status\nconst issueIds=fetchedIssues.map(i=>i.id).join(',');let userVotesMap={};if(issueIds.length>0){try{const userVotesResp=await axios.get(\"\".concat(API_BASE_URL,\"/votes/user-votes\"),{params:{issues:issueIds},withCredentials:true});userVotesMap=userVotesResp.data.data||{};}catch(err){var _err$response;console.warn(\"Failed to fetch user votes on load:\",((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.data)||err.message);}}// â­ This is the key step that ensures the 'voted' class is set on load\nsetUserVotes(userVotesMap);// Fetch overall vote counts\nconst countsPromises=fetchedIssues.map(i=>axios.get(\"\".concat(API_BASE_URL,\"/votes/\").concat(i.id),{withCredentials:true}).then(r=>({id:i.id,counts:r.data.data})).catch(()=>({id:i.id,counts:{upvote:0,downVote:0}})));const countsResults=await Promise.all(countsPromises);const countsMap=countsResults.reduce((acc,item)=>{acc[item.id]=item.counts;return acc;},{});const issuesWithCounts=fetchedIssues.map(i=>_objectSpread(_objectSpread({},i),{},{counts:countsMap[i.id]||{upvote:0,downVote:0}}));setIssues(issuesWithCounts);setFilteredIssues(issuesWithCounts);}catch(error){var _error$response;console.error(\"Failed to fetch issues:\",((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data)||error.message);setIssues([]);setFilteredIssues([]);}finally{setLoading(false);}},[user,searchTerm,filters]);useEffect(()=>{const checkAuthStatus=async()=>{// Wait briefly for AuthContext to resolve the user state on refresh\nawait new Promise(resolve=>setTimeout(resolve,50));setAuthChecked(true);};checkAuthStatus();},[]);// â­ FIX 1: Corrected useEffect logic for authentication and page reload\nuseEffect(()=>{if(!authChecked)return;// If user object is null/undefined after auth check, redirect to login\nif(!user){navigate('/login');}else{// If user object exists, stay on the page and fetch data\nfetchIssues();}},[user,navigate,fetchIssues,authChecked]);// --- VOTE Handler (Upvote & Downvote) ---\nconst handleVote=async(issueId,voteType)=>{if(!user){alert(\"Please login to vote.\");return;}const currentUserVote=userVotes[issueId];// Prevent rapid clicks\nif(busyVotes[issueId])return;let endpoint=\"\".concat(API_BASE_URL,\"/votes/\").concat(issueId,\"?category=\").concat(voteType);setBusyVotes(prev=>_objectSpread(_objectSpread({},prev),{},{[issueId]:true}));// Optimistic Update: Calculate new counts and new user vote state immediately\nconst updatedIssuesOptimistic=issues.map(issue=>{if(issue.id!==issueId)return issue;const counts=_objectSpread({},issue.counts);const prevUserVote=currentUserVote;// 1. Remove previous vote\nif(prevUserVote==='upvote')counts.upvote=Math.max(0,counts.upvote-1);if(prevUserVote==='downvote')counts.downVote=Math.max(0,counts.downVote-1);let newUserVote;if(prevUserVote===voteType){newUserVote=undefined;// toggled off (vote deleted)\n}else{// 2. Add new vote (new vote set or changed)\nif(voteType==='upvote')counts.upvote=(counts.upvote||0)+1;else counts.downVote=(counts.downVote||0)+1;newUserVote=voteType;}return _objectSpread(_objectSpread({},issue),{},{counts,_newUserVote:newUserVote});});// Apply the new user vote state permanently\nconst newUserVoteState=updatedIssuesOptimistic.reduce((acc,issue)=>{if(issue.id===issueId){acc[issue.id]=issue._newUserVote;}else if(userVotes.hasOwnProperty(issue.id)){acc[issue.id]=userVotes[issue.id];}delete issue._newUserVote;return acc;},{});// This optimistic update immediately changes the button's appearance (color/disabled state)\nsetUserVotes(newUserVoteState);setIssues(updatedIssuesOptimistic);setFilteredIssues(updatedIssuesOptimistic);try{const resp=await axios.post(endpoint,{},{withCredentials:true});const returned=resp.data.data;const returnedCounts=(returned===null||returned===void 0?void 0:returned.counts)||resp.data.data;if(returnedCounts){setIssues(prev=>prev.map(i=>i.id===issueId?_objectSpread(_objectSpread({},i),{},{counts:returnedCounts}):i));setFilteredIssues(prev=>prev.map(i=>i.id===issueId?_objectSpread(_objectSpread({},i),{},{counts:returnedCounts}):i));}}catch(error){var _error$response2,_error$response3,_error$response3$data;console.error(\"Vote action failed:\",((_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.data)||error.message);// Rollback visual state by re-fetching on error\nfetchIssues();alert(\"Vote action failed: \".concat(((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.message)||'Check network/server logic.'));}finally{// Restore busy state regardless of success/failure\nsetBusyVotes(prev=>_objectSpread(_objectSpread({},prev),{},{[issueId]:false}));}};// --- Comments: fetch for a single complaint ---\nconst fetchComments=async complaintId=>{setCommentsOpen(prev=>_objectSpread(_objectSpread({},prev),{},{[complaintId]:true}));if(commentsStore[complaintId])return;try{const resp=await axios.get(\"\".concat(API_BASE_URL,\"/comments/\").concat(complaintId),{withCredentials:true});setCommentsStore(prev=>_objectSpread(_objectSpread({},prev),{},{[complaintId]:resp.data.data}));}catch(err){var _err$response2;console.error(\"Failed to fetch comments\",((_err$response2=err.response)===null||_err$response2===void 0?void 0:_err$response2.data)||err.message);setCommentsStore(prev=>_objectSpread(_objectSpread({},prev),{},{[complaintId]:[]}));}};const toggleComments=complaintId=>{const isOpen=!!commentsOpen[complaintId];if(!isOpen){fetchComments(complaintId);}else{setCommentsOpen(prev=>_objectSpread(_objectSpread({},prev),{},{[complaintId]:false}));}};const handleCommentChange=(issueId,value)=>{setCommentDrafts(prev=>_objectSpread(_objectSpread({},prev),{},{[issueId]:value}));};const deleteComment=async(issueId,commentId)=>{if(!window.confirm(\"Are you sure you want to delete this comment?\"))return;const prevComments=commentsStore[issueId]||[];// Optimistic removal\nsetCommentsStore(prev=>_objectSpread(_objectSpread({},prev),{},{[issueId]:prev[issueId].filter(c=>c._id!==commentId)}));try{await axios.delete(\"\".concat(API_BASE_URL,\"/comments/\").concat(issueId,\"/\").concat(commentId),{withCredentials:true});// decrement comment count\nsetIssues(prev=>prev.map(i=>i.id===issueId?_objectSpread(_objectSpread({},i),{},{comments:(i.comments||1)-1}):i));setFilteredIssues(prev=>prev.map(i=>i.id===issueId?_objectSpread(_objectSpread({},i),{},{comments:(i.comments||1)-1}):i));}catch(err){var _err$response3;console.error(\"Failed to delete comment:\",((_err$response3=err.response)===null||_err$response3===void 0?void 0:_err$response3.data)||err.message);alert(\"Failed to delete comment\");// rollback\nsetCommentsStore(prev=>_objectSpread(_objectSpread({},prev),{},{[issueId]:prevComments}));}};// --- Start Editing Comment (Corrected to use 'editingComment') ---\nconst startEditComment=comment=>{setEditingComment({commentId:comment._id,content:comment.content});};// --- Update Comment Handler (FINAL FIX for consistency and state atomicity) ---\nconst updateComment=async(issueId,commentId,newContent)=>{const trimmedContent=newContent.trim();// Use editingComment state for comparison\nif(!trimmedContent||trimmedContent===((editingComment===null||editingComment===void 0?void 0:editingComment.content)||'')){setEditingComment(null);// Cancel if empty or unchanged\nreturn;}setBusyComments(prev=>_objectSpread(_objectSpread({},prev),{},{[commentId]:true}));const currentComment=commentsStore[issueId].find(c=>c._id===commentId);const prevContent=currentComment===null||currentComment===void 0?void 0:currentComment.content;const prevUpdatedAt=currentComment===null||currentComment===void 0?void 0:currentComment.updatedAt;// Capture original timestamp for rollback\n// 1. Optimistic update (Crucial: Retain the existing populated `userId` object)\nsetCommentsStore(prev=>_objectSpread(_objectSpread({},prev),{},{[issueId]:prev[issueId].map(c=>c._id===commentId?_objectSpread(_objectSpread({},c),{},{content:trimmedContent,// Simulate an update timestamp. Use a new Date string.\nupdatedAt:new Date().toISOString(),userId:currentComment.userId}):c)}));setEditingComment(null);// Exit edit mode immediately\ntry{// 2. API call to update the comment\n// The URL path must match the backend route: /comments/:complaintId/:commentId\nconst resp=await axios.put(\"\".concat(API_BASE_URL,\"/comments/\").concat(issueId,\"/\").concat(commentId),{content:trimmedContent},{withCredentials:true});const updated=resp.data.data;// 3. Final update from server response (atomic replacement)\nsetCommentsStore(prev=>_objectSpread(_objectSpread({},prev),{},{[issueId]:prev[issueId].map(c=>c._id===commentId?updated:c)}));}catch(err){var _err$response4;console.error(\"Failed to update comment\",((_err$response4=err.response)===null||_err$response4===void 0?void 0:_err$response4.data)||err.message);alert(\"Failed to update comment. Rolling back.\");// 4. Rollback on error\nsetCommentsStore(prev=>_objectSpread(_objectSpread({},prev),{},{[issueId]:prev[issueId].map(c=>c._id===commentId?_objectSpread(_objectSpread({},c),{},{content:prevContent,updatedAt:prevUpdatedAt}):c)}));// 5. Re-open edit state with old content for user to retry\nsetEditingComment({commentId,content:prevContent});}finally{setBusyComments(prev=>_objectSpread(_objectSpread({},prev),{},{[commentId]:false}));}};const postComment=useCallback(async issueId=>{const text=(commentDrafts[issueId]||'').trim();if(!text)return alert(\"Comment can't be empty\");setBusyComments(prev=>_objectSpread(_objectSpread({},prev),{},{[issueId]:true}));// --- Include current user details for optimistic comment and correct display ---\nconst tempComment={_id:\"temp-\".concat(Date.now()),// Populate userId as an object so the comment item can display the name correctly\nuserId:{_id:user._id,name:user.name},complaintId:issueId,content:text,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};// -------------------------------------------------------------------------------------\nsetCommentsStore(prev=>_objectSpread(_objectSpread({},prev),{},{[issueId]:[tempComment,...(prev[issueId]||[])]}));setCommentDrafts(prev=>_objectSpread(_objectSpread({},prev),{},{[issueId]:\"\"}));try{const resp=await axios.post(\"\".concat(API_BASE_URL,\"/comments/\").concat(issueId),{content:text},{withCredentials:true});const created=resp.data.data;// Replace temp comment with actual\nsetCommentsStore(prev=>_objectSpread(_objectSpread({},prev),{},{[issueId]:prev[issueId].map(c=>c._id===tempComment._id?created:c)}));// increment comment count on issue\nsetIssues(prev=>prev.map(i=>i.id===issueId?_objectSpread(_objectSpread({},i),{},{comments:(i.comments||0)+1}):i));setFilteredIssues(prev=>prev.map(i=>i.id===issueId?_objectSpread(_objectSpread({},i),{},{comments:(i.comments||0)+1}):i));}catch(err){var _err$response5;console.error(\"Failed to post comment\",((_err$response5=err.response)===null||_err$response5===void 0?void 0:_err$response5.data)||err.message);// rollback optimistic append\nsetCommentsStore(prev=>_objectSpread(_objectSpread({},prev),{},{[issueId]:(prev[issueId]||[]).filter(c=>c._id!==tempComment._id)}));alert(\"Failed to post comment\");}finally{setBusyComments(prev=>_objectSpread(_objectSpread({},prev),{},{[issueId]:false}));}},[commentDrafts,user]);// --- Other Handlers ---\nconst handleFilterChange=(filterType,value)=>{setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{[filterType]:value}));};const handleSearchChange=e=>{setSearchTerm(e.target.value);};const handleLogout=()=>{axios.post(\"\".concat(API_BASE_URL,\"/users/logout\"),{},{withCredentials:true}).catch(()=>{}).finally(()=>{signOut();navigate('/');});};const clearFilters=()=>{setSearchTerm('');setFilters({category:'All Categories',status:'All Statuses',sort:'Newest First'});};if(!authChecked){return/*#__PURE__*/_jsxs(\"div\",{className:\"loading-state full-page-loading\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Checking authentication status...\"})]});}if(!user){return null;}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"header\",{className:\"header-top\",children:[/*#__PURE__*/_jsxs(\"nav\",{className:\"nav-links\",children:[/*#__PURE__*/_jsx(Link,{to:\"/dashboard\",children:\"Dashboard\"}),/*#__PURE__*/_jsx(Link,{to:\"/browse-issues\",className:\"active\",children:\"Browse Issues\"}),/*#__PURE__*/_jsx(Link,{to:\"/report-issue\",children:\"Report Issue\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-profile\",children:[/*#__PURE__*/_jsxs(Link,{to:\"/profile\",className:\"profile-link\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"user-initials\",children:getUserInitials(user.name)}),/*#__PURE__*/_jsx(\"span\",{className:\"user-name\",children:user.name})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,className:\"logout-btn-header\",children:/*#__PURE__*/_jsx(ArrowRight,{size:20})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-hero\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"hero-background\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"hero-content-wrapper\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"hero-badge\",children:\"Community Platform\"}),/*#__PURE__*/_jsx(\"h1\",{children:\"Discover & Support Local Issues\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Join thousands of community members in identifying, voting, and resolving neighborhood concerns. Together we build better communities.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"hero-stats\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"hero-stat\",children:[/*#__PURE__*/_jsx(\"strong\",{children:communityImpact.totalReports}),/*#__PURE__*/_jsx(\"span\",{children:\"Issues Reported\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"hero-stat\",children:[/*#__PURE__*/_jsx(\"strong\",{children:communityImpact.issuesResolved}),/*#__PURE__*/_jsx(\"span\",{children:\"Issues Resolved\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"hero-stat\",children:[/*#__PURE__*/_jsx(\"strong\",{children:communityImpact.activeUsers}),/*#__PURE__*/_jsx(\"span\",{children:\"Active Members\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"hero-buttons\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"hero-btn-primary\",onClick:()=>navigate('/report-issue'),children:[/*#__PURE__*/_jsx(PlusCircle,{size:18}),/*#__PURE__*/_jsx(\"span\",{children:\"Report New Issue\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"hero-btn-secondary\",onClick:()=>navigate('/dashboard'),children:/*#__PURE__*/_jsx(\"span\",{children:\"View Dashboard\"})})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"browse-issues-main\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"browse-sidebar\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar-panel\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"panel-header\",children:[/*#__PURE__*/_jsx(BarChart3,{size:20,className:\"panel-icon\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"Issue Categories\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"panel-subtitle\",children:\"Browse by issue type\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"categories-list\",children:[issueCategories.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"category-item \".concat(filters.category===item.category?'active':''),onClick:()=>handleFilterChange('category',item.category),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"category-icon-title\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"category-icon\",style:{backgroundColor:item.color},children:item.icon}),/*#__PURE__*/_jsx(\"span\",{className:\"category-title\",children:item.category})]}),/*#__PURE__*/_jsx(\"span\",{className:\"category-count\",style:{backgroundColor:item.color},children:issues.filter(i=>i.category===item.category).length})]},index)),/*#__PURE__*/_jsxs(\"div\",{className:\"category-item \".concat(filters.category==='All Categories'?'active':''),onClick:()=>handleFilterChange('category','All Categories'),children:[/*#__PURE__*/_jsx(\"div\",{className:\"category-icon-title\",children:/*#__PURE__*/_jsx(\"span\",{className:\"category-title\",children:\"All Categories\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"category-count\",children:issues.length})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar-panel\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"panel-header\",children:[/*#__PURE__*/_jsx(Users,{size:20,className:\"panel-icon\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"Community Impact\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"impact-stats\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"impact-stat-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"impact-icon\",children:\"\\u2705\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"impact-content\",children:[/*#__PURE__*/_jsx(\"strong\",{children:communityImpact.issuesResolved}),/*#__PURE__*/_jsx(\"span\",{children:\"Issues Resolved\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"impact-stat-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"impact-icon\",children:\"\\u26A1\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"impact-content\",children:[/*#__PURE__*/_jsx(\"strong\",{children:communityImpact.responseTime}),/*#__PURE__*/_jsx(\"span\",{children:\"Avg Response Time\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"impact-stat-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"impact-icon\",children:\"\\u2B50\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"impact-content\",children:[/*#__PURE__*/_jsx(\"strong\",{children:communityImpact.communityScore}),/*#__PURE__*/_jsx(\"span\",{children:\"Community Score\"})]})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"browse-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"content-panel filter-panel\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"panel-header-main\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"panel-title\",children:[/*#__PURE__*/_jsx(Filter,{size:24,className:\"title-icon\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Filter & Search Issues\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Find and engage with community concerns\"})]})]}),(searchTerm||filters.category!=='All Categories'||filters.status!=='All Statuses')&&/*#__PURE__*/_jsx(\"button\",{onClick:clearFilters,className:\"clear-filters-btn\",children:/*#__PURE__*/_jsx(\"span\",{children:\"Clear All\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"search-section\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"search-bar\",children:[/*#__PURE__*/_jsx(Search,{size:20,className:\"search-icon\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search issues by title, description, location...\",value:searchTerm,onChange:handleSearchChange,className:\"search-input\"}),searchTerm&&/*#__PURE__*/_jsx(\"button\",{className:\"clear-search-btn\",onClick:()=>setSearchTerm(''),children:\"\\xD7\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-controls\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"filter-group\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"filter-label\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"filter-label-icon\",children:\"\\uD83D\\uDCC1\"}),\"Category\"]}),/*#__PURE__*/_jsx(\"select\",{value:filters.category,onChange:e=>handleFilterChange('category',e.target.value),className:\"filter-select\",children:categories.map(category=>/*#__PURE__*/_jsx(\"option\",{value:category,children:category},category))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-group\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"filter-label\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"filter-label-icon\",children:\"\\uD83D\\uDD04\"}),\"Status\"]}),/*#__PURE__*/_jsx(\"select\",{value:filters.status,onChange:e=>handleFilterChange('status',e.target.value),className:\"filter-select\",children:statusOptions.map(status=>/*#__PURE__*/_jsx(\"option\",{value:status,children:status},status))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-group\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"filter-label\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"filter-label-icon\",children:\"\\uD83D\\uDCCA\"}),\"Sort By\"]}),/*#__PURE__*/_jsx(\"select\",{value:filters.sort,onChange:e=>handleFilterChange('sort',e.target.value),className:\"filter-select\",children:sortOptions.map(option=>/*#__PURE__*/_jsx(\"option\",{value:option,children:option},option))})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"results-info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"results-count\",children:[/*#__PURE__*/_jsx(\"strong\",{children:filteredIssues.length}),/*#__PURE__*/_jsxs(\"span\",{children:[filteredIssues.length===1?' issue':' issues',\" found\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"community-engagement\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"engagement-badge\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"engagement-dot\"}),\"High Community Engagement\"]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"content-panel issues-panel\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"panel-header-main\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"panel-title\",children:[/*#__PURE__*/_jsx(FileText,{size:24,className:\"title-icon\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Community Issues\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Recent reports from your neighborhood\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"active-filters\",children:[filters.category!=='All Categories'&&/*#__PURE__*/_jsxs(\"span\",{className:\"active-filter-tag\",children:[\"Category: \",filters.category]}),filters.status!=='All Statuses'&&/*#__PURE__*/_jsxs(\"span\",{className:\"active-filter-tag\",children:[\"Status: \",filters.status]}),filters.sort!=='Newest First'&&/*#__PURE__*/_jsxs(\"span\",{className:\"active-filter-tag\",children:[\"Sorted by: \",filters.sort]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"issues-list-container\",children:loading?/*#__PURE__*/_jsxs(\"div\",{className:\"loading-state\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading community issues...\"}),/*#__PURE__*/_jsx(\"span\",{className:\"loading-subtitle\",children:\"Fetching the latest reports from the server\"})]}):filteredIssues.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"empty-icon\",children:\"\\uD83D\\uDD0D\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"No issues found\"}),/*#__PURE__*/_jsx(\"p\",{children:\"We couldn't find any issues matching your search criteria.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:clearFilters,className:\"clear-filters-btn large\",children:\"Clear All Filters\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"issues-grid\",children:filteredIssues.map(issue=>{var _issueCategories$find,_issueCategories$find2,_issue$counts,_issue$counts2;return/*#__PURE__*/_jsxs(\"div\",{className:\"issue-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"issue-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"issue-meta-left\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"issue-category-tag\",style:{backgroundColor:((_issueCategories$find=issueCategories.find(c=>c.category===issue.category))===null||_issueCategories$find===void 0?void 0:_issueCategories$find.color)+'20',color:(_issueCategories$find2=issueCategories.find(c=>c.category===issue.category))===null||_issueCategories$find2===void 0?void 0:_issueCategories$find2.color},children:issue.category}),/*#__PURE__*/_jsxs(\"div\",{className:\"priority-indicator priority-\".concat(issue.priority),children:[/*#__PURE__*/_jsx(\"div\",{className:\"priority-dot priority-\".concat(issue.priority)}),issue.priority,\" priority\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"issue-urgency\",children:issue.urgency})]}),/*#__PURE__*/_jsx(\"h4\",{className:\"issue-title\",children:issue.title}),/*#__PURE__*/_jsx(\"p\",{className:\"issue-description\",children:issue.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"issue-meta\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"meta-item\",children:[/*#__PURE__*/_jsx(MapPin,{size:16}),/*#__PURE__*/_jsx(\"span\",{children:issue.location})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"meta-item\",children:[/*#__PURE__*/_jsx(Clock,{size:16}),/*#__PURE__*/_jsx(\"span\",{children:getRelativeTime(issue.createdAt)})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"issue-footer\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"user-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"user-avatar-small\",children:issue.userAvatar}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-details\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"user-name\",children:issue.user}),/*#__PURE__*/_jsx(\"span\",{className:\"report-time\",children:getRelativeTime(issue.createdAt)})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"issue-actions\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"vote-section\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"vote-btn upvote \".concat(userVotes[issue.id]==='upvote'?'voted':''),onClick:()=>handleVote(issue.id,'upvote')// â­ FIX 2: Disable if already upvoted OR busy. This is the logic to stop re-voting the same type.\n,disabled:userVotes[issue.id]==='upvote'||busyVotes[issue.id],children:[/*#__PURE__*/_jsx(Heart,{size:16}),/*#__PURE__*/_jsx(\"span\",{children:((_issue$counts=issue.counts)===null||_issue$counts===void 0?void 0:_issue$counts.upvote)||0})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"vote-btn downvote \".concat(userVotes[issue.id]==='downvote'?'voted':''),onClick:()=>handleVote(issue.id,'downvote')// â­ FIX 3: Disable if already downvoted OR busy.\n,disabled:userVotes[issue.id]==='downvote'||busyVotes[issue.id],children:[/*#__PURE__*/_jsx(ThumbsDown,{size:16}),/*#__PURE__*/_jsx(\"span\",{children:((_issue$counts2=issue.counts)===null||_issue$counts2===void 0?void 0:_issue$counts2.downVote)||0})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"status-badge status-\".concat(issue.status.replace(' ','').toLowerCase()),children:issue.status})]}),/*#__PURE__*/_jsx(\"div\",{className:\"comments-toggle\",children:/*#__PURE__*/_jsxs(\"button\",{className:\"comments-open-btn\",onClick:()=>toggleComments(issue.id),children:[/*#__PURE__*/_jsx(ChevronsDown,{size:14}),\" \",commentsOpen[issue.id]?'Hide':'Show',\" Comments (\",issue.comments||0,\")\"]})}),commentsOpen[issue.id]&&/*#__PURE__*/_jsxs(\"div\",{className:\"comments-panel\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"add-comment\",children:[/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Write your comment...\",value:commentDrafts[issue.id]||'',onChange:e=>handleCommentChange(issue.id,e.target.value),rows:2}),/*#__PURE__*/_jsx(\"div\",{className:\"comment-actions\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>postComment(issue.id),disabled:busyComments[issue.id],children:busyComments[issue.id]?'Posting...':'Post Comment'})})]}),(commentsStore[issue.id]||[]).map(c=>{var _c$userId,_c$userId2;// --- Use user name from populated userId object/temp object ---\nconst commenterName=((_c$userId=c.userId)===null||_c$userId===void 0?void 0:_c$userId.name)||'User';const isOwner=(((_c$userId2=c.userId)===null||_c$userId2===void 0?void 0:_c$userId2._id)||c.userId)===user._id;const isEditing=(editingComment===null||editingComment===void 0?void 0:editingComment.commentId)===c._id;return/*#__PURE__*/_jsxs(\"div\",{className:\"comment-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"comment-avatar\",children:commenterName[0].toUpperCase()}),/*#__PURE__*/_jsx(\"div\",{className:\"comment-body\",children:isEditing?/*#__PURE__*/_jsxs(\"div\",{className:\"edit-comment-area\",children:[/*#__PURE__*/_jsx(\"textarea\",{// Use the content from the editing state\nvalue:editingComment.content,onChange:e=>setEditingComment(prev=>_objectSpread(_objectSpread({},prev),{},{content:e.target.value})),rows:3}),/*#__PURE__*/_jsxs(\"div\",{className:\"comment-actions\",children:[/*#__PURE__*/_jsxs(\"button\",{// Pass content from the editing state\nonClick:()=>updateComment(issue.id,c._id,editingComment.content),disabled:busyComments[c._id],children:[/*#__PURE__*/_jsx(Save,{size:14}),\" \",busyComments[c._id]?'Saving...':'Save']}),/*#__PURE__*/_jsx(\"button\",{className:\"cancel-edit-btn\",onClick:()=>setEditingComment(null),children:\"Cancel\"})]})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"comment-meta\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"comment-author\",children:commenterName}),/*#__PURE__*/_jsxs(\"span\",{className:\"comment-time\",children:[getRelativeTime(c.createdAt),c.updatedAt&&c.updatedAt.toString()!==c.createdAt.toString()&&new Date(c.updatedAt)>new Date(c.createdAt)?' (edited)':'']}),isOwner&&/*#__PURE__*/_jsx(\"div\",{className:\"comment-owner-actions\",children:/*#__PURE__*/_jsx(\"button\",{className:\"delete-comment-btn\",onClick:()=>deleteComment(issue.id,c._id),children:\"\\uD83D\\uDDD1\\uFE0F\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"comment-content\",children:c.content})]})})]},c._id);})]})]},issue.id);})})})]})]})]})]}),/*#__PURE__*/_jsxs(\"footer\",{className:\"footer\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"footer-column footer-logo-section\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"footer-tagline\",children:\"Civic Engagement Platform\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Empowering communities to report, track, and resolve civic issues through collaborative engagement between citizens and local authorities.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"footer-column\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Platform\"}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"a\",{href:\"/\",children:\"How it Works\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"a\",{href:\"/\",children:\"Features\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"a\",{href:\"/\",children:\"Pricing\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"a\",{href:\"/\",children:\"Mobile App\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"footer-column\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Support\"}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"a\",{href:\"/\",children:\"Help Center\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"a\",{href:\"/\",children:\"Contact Us\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"a\",{href:\"/\",children:\"User Guide\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"a\",{href:\"/\",children:\"Community Forum\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"footer-column\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Company\"}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"a\",{href:\"/\",children:\"About Us\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"a\",{href:\"/\",children:\"Careers\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"a\",{href:\"/\",children:\"Press Kit\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"a\",{href:\"/\",children:\"Blog\"})})]})]})]})]});};export default UserBrowseIssue;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useMemo","Link","useNavigate","axios","useAuth","Search","Filter","MapPin","ArrowRight","BarChart3","Users","FileText","PlusCircle","Heart","MessageSquare","Eye","Clock","ChevronsDown","ThumbsDown","Edit","Save","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","API_BASE_URL","getRelativeTime","isoDateString","reportDate","Date","today","startOfToday","getFullYear","getMonth","getDate","startOfReportDay","diffTime","getTime","diffDays","Math","floor","hoursDiff","concat","getUserInitials","name","nameParts","split","initials","map","part","join","toUpperCase","UserBrowseIssue","user","signOut","navigate","authChecked","setAuthChecked","issues","setIssues","filteredIssues","setFilteredIssues","loading","setLoading","searchTerm","setSearchTerm","filters","setFilters","category","status","sort","userVotes","setUserVotes","commentsOpen","setCommentsOpen","commentsStore","setCommentsStore","commentDrafts","setCommentDrafts","busyComments","setBusyComments","busyVotes","setBusyVotes","editingComment","setEditingComment","categories","statusOptions","sortOptions","issueCategories","count","icon","color","communityImpact","issuesResolved","responseTime","communityScore","activeUsers","totalReports","fetchIssues","params","search","trim","response","get","withCredentials","fetchedIssues","data","comp","_comp$address","_comp$userId","_comp$comments","statusText","locationText","address","userName","userId","reverseCategoryMap","displayCategory","assignedTo","id","_id","title","description","location","createdAt","votes","comments","length","views","random","priority","urgency","userAvatar","counts","upvote","downVote","issueIds","i","userVotesMap","userVotesResp","err","_err$response","console","warn","message","countsPromises","then","r","catch","countsResults","Promise","all","countsMap","reduce","acc","item","issuesWithCounts","_objectSpread","error","_error$response","checkAuthStatus","resolve","setTimeout","handleVote","issueId","voteType","alert","currentUserVote","endpoint","prev","updatedIssuesOptimistic","issue","prevUserVote","max","newUserVote","undefined","_newUserVote","newUserVoteState","hasOwnProperty","resp","post","returned","returnedCounts","_error$response2","_error$response3","_error$response3$data","fetchComments","complaintId","_err$response2","toggleComments","isOpen","handleCommentChange","value","deleteComment","commentId","window","confirm","prevComments","filter","c","delete","_err$response3","startEditComment","comment","content","updateComment","newContent","trimmedContent","currentComment","find","prevContent","prevUpdatedAt","updatedAt","toISOString","put","updated","_err$response4","postComment","text","tempComment","now","created","_err$response5","handleFilterChange","filterType","handleSearchChange","e","target","handleLogout","finally","clearFilters","className","children","to","onClick","size","index","style","backgroundColor","type","placeholder","onChange","option","_issueCategories$find","_issueCategories$find2","_issue$counts","_issue$counts2","disabled","replace","toLowerCase","rows","_c$userId","_c$userId2","commenterName","isOwner","isEditing","toString","href"],"sources":["C:/Users/saksh/OneDrive/Desktop/DS/civiceye/civiceye/frontend/src/pages/IssuesBrowser.js"],"sourcesContent":["import React, { useState, useEffect, useCallback, useMemo } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { Search, Filter, MapPin, ArrowRight, BarChart3, Users, FileText, PlusCircle, Heart, MessageSquare, Eye, Clock, ChevronsDown, ThumbsDown, Edit, Save } from 'lucide-react'; \r\nimport './IssuesBrowser.css';\r\n\r\nconst API_BASE_URL = 'http://localhost:3000/api/v1'; // Define API URL\r\n\r\n// --- Time utility ---\r\nconst getRelativeTime = (isoDateString) => {\r\n    const reportDate = new Date(isoDateString);\r\n    const today = new Date();\r\n    const startOfToday = new Date(today.getFullYear(), today.getMonth(), today.getDate());\r\n    const startOfReportDay = new Date(reportDate.getFullYear(), reportDate.getMonth(), reportDate.getDate());\r\n    const diffTime = startOfToday.getTime() - startOfReportDay.getTime();\r\n    const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));\r\n\r\n    if (diffDays === 0) {\r\n        const hoursDiff = Math.floor((today.getTime() - reportDate.getTime()) / (1000 * 60 * 60));\r\n        if (hoursDiff === 0) return 'Just now';\r\n        if (hoursDiff < 24) return `${hoursDiff} hours ago`;\r\n        return 'Today';\r\n    }\r\n    if (diffDays === 1) return 'Yesterday';\r\n    if (diffDays < 7) return `${diffDays} days ago`;\r\n    if (diffDays < 30) return `${Math.floor(diffDays / 7)} weeks ago`;\r\n    return `${Math.floor(diffDays / 30)} months ago`;\r\n};\r\n\r\nconst getUserInitials = (name) => {\r\n    if (!name) return 'JD';\r\n    const nameParts = name.split(' ');\r\n    const initials = nameParts.map(part => part[0]).join('');\r\n    return initials.toUpperCase();\r\n};\r\n\r\nconst UserBrowseIssue = () => {\r\n    const { user, signOut } = useAuth();\r\n    const navigate = useNavigate();\r\n\r\n    const [authChecked, setAuthChecked] = useState(false);\r\n    const [issues, setIssues] = useState([]);\r\n    const [filteredIssues, setFilteredIssues] = useState([]);\r\n    const [loading, setLoading] = useState(false);\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n    const [filters, setFilters] = useState({\r\n        category: 'All Categories',\r\n        status: 'All Statuses',\r\n        sort: 'Newest First'\r\n    });\r\n    // userVotes state is crucial for persistent coloring\r\n    const [userVotes, setUserVotes] = useState({});\r\n    const [commentsOpen, setCommentsOpen] = useState({});\r\n    const [commentsStore, setCommentsStore] = useState({});\r\n    const [commentDrafts, setCommentDrafts] = useState({});\r\n    const [busyComments, setBusyComments] = useState({});\r\n    // State to manage voting action busy status\r\n    const [busyVotes, setBusyVotes] = useState({}); \r\n\r\n    // Consistent state name\r\n    const [editingComment, setEditingComment] = useState(null); \r\n\r\n    const categories = useMemo(() => [\r\n        'All Categories', 'Garbage & Waste', 'Potholes', 'Water Issues', 'Street Lights', 'Vandalism', 'Other'\r\n    ], []);\r\n\r\n    const statusOptions = useMemo(() => [\r\n        'All Statuses', 'Pending', 'In Progress', 'Resolved'\r\n    ], []);\r\n\r\n    const sortOptions = useMemo(() => [\r\n        'Newest First', 'Oldest First', 'Most Voted', 'Most Viewed', 'Priority'\r\n    ], []);\r\n\r\n    const issueCategories = useMemo(() => [\r\n        { category: 'Garbage & Waste', count: 0, icon: 'ðŸ—‘ï¸', color: '#E53E3E' },\r\n        { category: 'Potholes', count: 0, icon: 'ðŸ•³ï¸', color: '#DD6B20' },\r\n        { category: 'Water Issues', count: 0, icon: 'ðŸ’§', color: '#3182CE' },\r\n        { category: 'Street Lights', count: 0, icon: 'ðŸ’¡', color: '#D69E2E' },\r\n        { category: 'Vandalism', count: 0, icon: 'ðŸŽ¨', color: '#805AD5' },\r\n        { category: 'Other', count: 0, icon: 'ðŸ“‹', color: '#718096' },\r\n    ], []);\r\n\r\n    const communityImpact = {\r\n        issuesResolved: '89+',\r\n        responseTime: '2.3 days avg',\r\n        communityScore: '95%',\r\n        activeUsers: '1.2k',\r\n        totalReports: '2.8k'\r\n    };\r\n\r\n    const fetchIssues = useCallback(async () => {\r\n        if (!user) return;\r\n        setLoading(true);\r\n\r\n        const params = {\r\n            search: searchTerm.trim(),\r\n            category: filters.category,\r\n            status: filters.status,\r\n            sort: filters.sort,\r\n        };\r\n\r\n        try {\r\n            const response = await axios.get(`${API_BASE_URL}/complaints/all`, {\r\n                params: params,\r\n                withCredentials: true\r\n            });\r\n\r\n            const fetchedIssues = response.data.data.map(comp => {\r\n                const statusText = comp.status === 'recived' ? 'Pending' : comp.status === 'inReview' ? 'In Progress' : comp.status === 'resolved' ? 'Resolved' : 'Pending';\r\n                const locationText = comp.address?.[0] || 'Unknown Location';\r\n                \r\n                const userName = typeof comp.userId === 'object' && comp.userId?.name\r\n                    ? comp.userId.name\r\n                    : 'Anonymous User';\r\n\r\n                const reverseCategoryMap = {\r\n                    'Municipal sanitation and public health': 'Garbage & Waste',\r\n                    'Roads and street infrastructure': 'Potholes',\r\n                    'Street lighting and electrical assets': 'Street Lights',\r\n                    'Water, sewerage, and stormwater': 'Water Issues',\r\n                    'Ward/zone office and central admin': 'Vandalism'\r\n                };\r\n                const displayCategory = reverseCategoryMap[comp.assignedTo] || 'Other';\r\n\r\n                return {\r\n                    id: comp._id,\r\n                    title: comp.title,\r\n                    description: comp.description,\r\n                    location: locationText,\r\n                    category: displayCategory,\r\n                    status: statusText,\r\n                    createdAt: comp.createdAt,\r\n                    votes: 0, \r\n                    comments: comp.comments?.length || 0,\r\n                    views: Math.floor(Math.random() * 200),\r\n                    priority: ['high', 'medium', 'low'][Math.floor(Math.random() * 3)],\r\n                    urgency: 'Community Concern',\r\n                    user: userName,\r\n                    userAvatar: getUserInitials(userName),\r\n                    counts: { upvote: 0, downVote: 0 } \r\n                };\r\n            });\r\n\r\n            // Fetch user-specific vote status\r\n            const issueIds = fetchedIssues.map(i => i.id).join(',');\r\n            let userVotesMap = {};\r\n            if (issueIds.length > 0) {\r\n                try {\r\n                    const userVotesResp = await axios.get(`${API_BASE_URL}/votes/user-votes`, {\r\n                        params: { issues: issueIds },\r\n                        withCredentials: true\r\n                    });\r\n                    userVotesMap = userVotesResp.data.data || {};\r\n                } catch (err) {\r\n                    console.warn(\"Failed to fetch user votes on load:\", err.response?.data || err.message);\r\n                }\r\n            }\r\n            // â­ This is the key step that ensures the 'voted' class is set on load\r\n            setUserVotes(userVotesMap); \r\n\r\n            // Fetch overall vote counts\r\n            const countsPromises = fetchedIssues.map(i =>\r\n                axios.get(`${API_BASE_URL}/votes/${i.id}`, { withCredentials: true })\r\n                    .then(r => ({ id: i.id, counts: r.data.data }))\r\n                    .catch(() => ({ id: i.id, counts: { upvote: 0, downVote: 0 } }))\r\n            );\r\n\r\n            const countsResults = await Promise.all(countsPromises);\r\n            const countsMap = countsResults.reduce((acc, item) => { acc[item.id] = item.counts; return acc; }, {});\r\n            const issuesWithCounts = fetchedIssues.map(i => ({ ...i, counts: countsMap[i.id] || { upvote: 0, downVote: 0 } }));\r\n            \r\n            setIssues(issuesWithCounts);\r\n            setFilteredIssues(issuesWithCounts);\r\n\r\n        } catch (error) {\r\n            console.error(\"Failed to fetch issues:\", error.response?.data || error.message);\r\n            setIssues([]);\r\n            setFilteredIssues([]);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }, [user, searchTerm, filters]);\r\n\r\n    useEffect(() => {\r\n        const checkAuthStatus = async () => {\r\n            // Wait briefly for AuthContext to resolve the user state on refresh\r\n            await new Promise(resolve => setTimeout(resolve, 50)); \r\n            setAuthChecked(true);\r\n        };\r\n        checkAuthStatus();\r\n    }, []);\r\n\r\n    // â­ FIX 1: Corrected useEffect logic for authentication and page reload\r\n    useEffect(() => {\r\n        if (!authChecked) return;\r\n        \r\n        // If user object is null/undefined after auth check, redirect to login\r\n        if (!user) {\r\n            navigate('/login');\r\n        } else {\r\n            // If user object exists, stay on the page and fetch data\r\n            fetchIssues();\r\n        }\r\n    }, [user, navigate, fetchIssues, authChecked]);\r\n\r\n    // --- VOTE Handler (Upvote & Downvote) ---\r\n    const handleVote = async (issueId, voteType) => {\r\n        if (!user) {\r\n            alert(\"Please login to vote.\");\r\n            return;\r\n        }\r\n        \r\n        const currentUserVote = userVotes[issueId]; \r\n        \r\n        // Prevent rapid clicks\r\n        if (busyVotes[issueId]) return;\r\n\r\n        let endpoint = `${API_BASE_URL}/votes/${issueId}?category=${voteType}`;\r\n        \r\n        setBusyVotes(prev => ({ ...prev, [issueId]: true }));\r\n\r\n        // Optimistic Update: Calculate new counts and new user vote state immediately\r\n        const updatedIssuesOptimistic = issues.map(issue => {\r\n            if (issue.id !== issueId) return issue;\r\n            const counts = { ...issue.counts };\r\n            const prevUserVote = currentUserVote;\r\n\r\n            // 1. Remove previous vote\r\n            if (prevUserVote === 'upvote') counts.upvote = Math.max(0, counts.upvote - 1);\r\n            if (prevUserVote === 'downvote') counts.downVote = Math.max(0, counts.downVote - 1);\r\n\r\n            let newUserVote;\r\n            if (prevUserVote === voteType) {\r\n                newUserVote = undefined; // toggled off (vote deleted)\r\n            } else {\r\n                // 2. Add new vote (new vote set or changed)\r\n                if (voteType === 'upvote') counts.upvote = (counts.upvote || 0) + 1;\r\n                else counts.downVote = (counts.downVote || 0) + 1;\r\n                newUserVote = voteType;\r\n            }\r\n\r\n            return { ...issue, counts, _newUserVote: newUserVote }; \r\n        });\r\n\r\n        // Apply the new user vote state permanently\r\n        const newUserVoteState = updatedIssuesOptimistic.reduce((acc, issue) => {\r\n            if (issue.id === issueId) {\r\n                acc[issue.id] = issue._newUserVote;\r\n            } else if (userVotes.hasOwnProperty(issue.id)) {\r\n                acc[issue.id] = userVotes[issue.id];\r\n            }\r\n            delete issue._newUserVote;\r\n            return acc;\r\n        }, {});\r\n\r\n        // This optimistic update immediately changes the button's appearance (color/disabled state)\r\n        setUserVotes(newUserVoteState); \r\n        setIssues(updatedIssuesOptimistic);\r\n        setFilteredIssues(updatedIssuesOptimistic);\r\n\r\n        try {\r\n            const resp = await axios.post(endpoint, {}, { withCredentials: true });\r\n            \r\n            const returned = resp.data.data;\r\n            const returnedCounts = returned?.counts || resp.data.data; \r\n\r\n            if (returnedCounts) {\r\n                setIssues(prev => prev.map(i => i.id === issueId ? { ...i, counts: returnedCounts } : i));\r\n                setFilteredIssues(prev => prev.map(i => i.id === issueId ? { ...i, counts: returnedCounts } : i));\r\n            }\r\n\r\n        } catch (error) {\r\n            console.error(\"Vote action failed:\", error.response?.data || error.message);\r\n            // Rollback visual state by re-fetching on error\r\n            fetchIssues(); \r\n            alert(`Vote action failed: ${error.response?.data?.message || 'Check network/server logic.'}`);\r\n        } finally {\r\n            // Restore busy state regardless of success/failure\r\n            setBusyVotes(prev => ({ ...prev, [issueId]: false }));\r\n        }\r\n    };\r\n\r\n\r\n    // --- Comments: fetch for a single complaint ---\r\n    const fetchComments = async (complaintId) => {\r\n        setCommentsOpen(prev => ({ ...prev, [complaintId]: true }));\r\n        if (commentsStore[complaintId]) return; \r\n\r\n        try {\r\n            const resp = await axios.get(`${API_BASE_URL}/comments/${complaintId}`, { withCredentials: true });\r\n            setCommentsStore(prev => ({ ...prev, [complaintId]: resp.data.data }));\r\n        } catch (err) {\r\n            console.error(\"Failed to fetch comments\", err.response?.data || err.message);\r\n            setCommentsStore(prev => ({ ...prev, [complaintId]: [] }));\r\n        }\r\n    };\r\n\r\n    const toggleComments = (complaintId) => {\r\n        const isOpen = !!commentsOpen[complaintId];\r\n        if (!isOpen) {\r\n            fetchComments(complaintId);\r\n        } else {\r\n            setCommentsOpen(prev => ({ ...prev, [complaintId]: false }));\r\n        }\r\n    };\r\n\r\n    const handleCommentChange = (issueId, value) => {\r\n        setCommentDrafts(prev => ({ ...prev, [issueId]: value }));\r\n    };\r\n\r\n    const deleteComment = async (issueId, commentId) => {\r\n        if (!window.confirm(\"Are you sure you want to delete this comment?\")) return;\r\n\r\n        const prevComments = commentsStore[issueId] || [];\r\n\r\n        // Optimistic removal\r\n        setCommentsStore(prev => ({\r\n            ...prev,\r\n            [issueId]: prev[issueId].filter(c => c._id !== commentId)\r\n        }));\r\n\r\n        try {\r\n            await axios.delete(`${API_BASE_URL}/comments/${issueId}/${commentId}`, { withCredentials: true });\r\n\r\n            // decrement comment count\r\n            setIssues(prev => prev.map(i => i.id === issueId ? { ...i, comments: (i.comments || 1) - 1 } : i));\r\n            setFilteredIssues(prev => prev.map(i => i.id === issueId ? { ...i, comments: (i.comments || 1) - 1 } : i));\r\n        } catch (err) {\r\n            console.error(\"Failed to delete comment:\", err.response?.data || err.message);\r\n            alert(\"Failed to delete comment\");\r\n            // rollback\r\n            setCommentsStore(prev => ({ ...prev, [issueId]: prevComments }));\r\n        }\r\n    };\r\n\r\n    // --- Start Editing Comment (Corrected to use 'editingComment') ---\r\n    const startEditComment = (comment) => {\r\n        setEditingComment({\r\n            commentId: comment._id,\r\n            content: comment.content\r\n        });\r\n    };\r\n\r\n    // --- Update Comment Handler (FINAL FIX for consistency and state atomicity) ---\r\n    const updateComment = async (issueId, commentId, newContent) => {\r\n        const trimmedContent = newContent.trim();\r\n        // Use editingComment state for comparison\r\n        if (!trimmedContent || trimmedContent === (editingComment?.content || '')) {\r\n            setEditingComment(null); // Cancel if empty or unchanged\r\n            return;\r\n        }\r\n\r\n        setBusyComments(prev => ({ ...prev, [commentId]: true }));\r\n        const currentComment = commentsStore[issueId].find(c => c._id === commentId);\r\n        const prevContent = currentComment?.content;\r\n        const prevUpdatedAt = currentComment?.updatedAt; // Capture original timestamp for rollback\r\n\r\n        // 1. Optimistic update (Crucial: Retain the existing populated `userId` object)\r\n        setCommentsStore(prev => ({\r\n            ...prev,\r\n            [issueId]: prev[issueId].map(c => \r\n                c._id === commentId \r\n                    ? { \r\n                        ...c, \r\n                        content: trimmedContent, \r\n                        // Simulate an update timestamp. Use a new Date string.\r\n                        updatedAt: new Date().toISOString(), \r\n                        userId: currentComment.userId \r\n                    } \r\n                    : c\r\n            )\r\n        }));\r\n        setEditingComment(null); // Exit edit mode immediately\r\n\r\n        try {\r\n            // 2. API call to update the comment\r\n            // The URL path must match the backend route: /comments/:complaintId/:commentId\r\n            const resp = await axios.put(`${API_BASE_URL}/comments/${issueId}/${commentId}`, { content: trimmedContent }, { withCredentials: true });\r\n            const updated = resp.data.data; \r\n\r\n            // 3. Final update from server response (atomic replacement)\r\n            setCommentsStore(prev => ({\r\n                ...prev,\r\n                [issueId]: prev[issueId].map(c => c._id === commentId ? updated : c)\r\n            }));\r\n        } catch (err) {\r\n            console.error(\"Failed to update comment\", err.response?.data || err.message);\r\n            alert(\"Failed to update comment. Rolling back.\");\r\n            \r\n            // 4. Rollback on error\r\n            setCommentsStore(prev => ({\r\n                ...prev,\r\n                [issueId]: prev[issueId].map(c => \r\n                    c._id === commentId ? { ...c, content: prevContent, updatedAt: prevUpdatedAt } : c\r\n                )\r\n            }));\r\n            \r\n            // 5. Re-open edit state with old content for user to retry\r\n            setEditingComment({ commentId, content: prevContent });\r\n        } finally {\r\n            setBusyComments(prev => ({ ...prev, [commentId]: false }));\r\n        }\r\n    };\r\n\r\n    const postComment = useCallback(async (issueId) => {\r\n        const text = (commentDrafts[issueId] || '').trim();\r\n        if (!text) return alert(\"Comment can't be empty\");\r\n        setBusyComments(prev => ({ ...prev, [issueId]: true }));\r\n\r\n        // --- Include current user details for optimistic comment and correct display ---\r\n        const tempComment = {\r\n            _id: `temp-${Date.now()}`,\r\n            // Populate userId as an object so the comment item can display the name correctly\r\n            userId: { _id: user._id, name: user.name }, \r\n            complaintId: issueId,\r\n            content: text,\r\n            createdAt: new Date().toISOString(),\r\n            updatedAt: new Date().toISOString()\r\n        };\r\n        // -------------------------------------------------------------------------------------\r\n\r\n        setCommentsStore(prev => ({ \r\n            ...prev, \r\n            [issueId]: [tempComment, ...(prev[issueId] || [])] \r\n        }));\r\n        setCommentDrafts(prev => ({ ...prev, [issueId]: \"\" }));\r\n\r\n        try {\r\n            const resp = await axios.post(`${API_BASE_URL}/comments/${issueId}`, { content: text }, { withCredentials: true });\r\n            const created = resp.data.data;\r\n\r\n            // Replace temp comment with actual\r\n            setCommentsStore(prev => ({\r\n                ...prev,\r\n                [issueId]: prev[issueId].map(c => c._id === tempComment._id ? created : c)\r\n            }));\r\n\r\n            // increment comment count on issue\r\n            setIssues(prev => prev.map(i => i.id === issueId ? { ...i, comments: (i.comments || 0) + 1 } : i));\r\n            setFilteredIssues(prev => prev.map(i => i.id === issueId ? { ...i, comments: (i.comments || 0) + 1 } : i));\r\n        } catch (err) {\r\n            console.error(\"Failed to post comment\", err.response?.data || err.message);\r\n            // rollback optimistic append\r\n            setCommentsStore(prev => ({ ...prev, [issueId]: (prev[issueId] || []).filter(c => c._id !== tempComment._id) }));\r\n            alert(\"Failed to post comment\");\r\n        } finally {\r\n            setBusyComments(prev => ({ ...prev, [issueId]: false }));\r\n        }\r\n    }, [commentDrafts, user]); \r\n\r\n    // --- Other Handlers ---\r\n    const handleFilterChange = (filterType, value) => {\r\n        setFilters(prev => ({\r\n            ...prev,\r\n            [filterType]: value\r\n        }));\r\n    };\r\n\r\n    const handleSearchChange = (e) => {\r\n        setSearchTerm(e.target.value);\r\n    };\r\n\r\n    const handleLogout = () => {\r\n        axios.post(`${API_BASE_URL}/users/logout`, {}, { withCredentials: true })\r\n            .catch(() => { })\r\n            .finally(() => {\r\n                signOut();\r\n                navigate('/');\r\n            });\r\n    };\r\n\r\n    const clearFilters = () => {\r\n        setSearchTerm('');\r\n        setFilters({\r\n            category: 'All Categories',\r\n            status: 'All Statuses',\r\n            sort: 'Newest First'\r\n        });\r\n    };\r\n\r\n    if (!authChecked) {\r\n        return (\r\n            <div className=\"loading-state full-page-loading\">\r\n                <div className=\"loading-spinner\"></div>\r\n                <p>Checking authentication status...</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (!user) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <>\r\n            {/* Header */}\r\n            <header className=\"header-top\">\r\n                \r\n                <nav className=\"nav-links\">\r\n                    <Link to=\"/dashboard\">Dashboard</Link>\r\n                    <Link to=\"/browse-issues\" className=\"active\">Browse Issues</Link>\r\n                    <Link to=\"/report-issue\">Report Issue</Link>\r\n                </nav>\r\n                <div className=\"user-profile\">\r\n                    <Link to=\"/profile\" className=\"profile-link\">\r\n                        <div className=\"user-initials\">{getUserInitials(user.name)}</div>\r\n                        <span className=\"user-name\">{user.name}</span>\r\n                    </Link>\r\n                    <button onClick={handleLogout} className=\"logout-btn-header\">\r\n                        <ArrowRight size={20} />\r\n                    </button>\r\n                </div>\r\n            </header>\r\n\r\n            <div className=\"dashboard-container\">\r\n                {/* Hero */}\r\n                <div className=\"dashboard-hero\">\r\n                    <div className=\"hero-background\"></div>\r\n                    <div className=\"hero-content-wrapper\">\r\n                        <div className=\"hero-badge\">Community Platform</div>\r\n                        <h1>Discover & Support Local Issues</h1>\r\n                        <p>Join thousands of community members in identifying, voting, and resolving neighborhood concerns. Together we build better communities.</p>\r\n                        <div className=\"hero-stats\">\r\n                            <div className=\"hero-stat\">\r\n                                <strong>{communityImpact.totalReports}</strong>\r\n                                <span>Issues Reported</span>\r\n                            </div>\r\n                            <div className=\"hero-stat\">\r\n                                <strong>{communityImpact.issuesResolved}</strong>\r\n                                <span>Issues Resolved</span>\r\n                            </div>\r\n                            <div className=\"hero-stat\">\r\n                                <strong>{communityImpact.activeUsers}</strong>\r\n                                <span>Active Members</span>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"hero-buttons\">\r\n                            <button className=\"hero-btn-primary\" onClick={() => navigate('/report-issue')}>\r\n                                <PlusCircle size={18} />\r\n                                <span>Report New Issue</span>\r\n                            </button>\r\n                            <button className=\"hero-btn-secondary\" onClick={() => navigate('/dashboard')}>\r\n                                <span>View Dashboard</span>\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"browse-issues-main\">\r\n                    <div className=\"browse-sidebar\">\r\n                        {/* Sidebar content */}\r\n                        <div className=\"sidebar-panel\">\r\n                            <div className=\"panel-header\">\r\n                                <BarChart3 size={20} className=\"panel-icon\" />\r\n                                <h4>Issue Categories</h4>\r\n                            </div>\r\n                            <p className=\"panel-subtitle\">Browse by issue type</p>\r\n                            <div className=\"categories-list\">\r\n                                {issueCategories.map((item, index) => (\r\n                                    <div\r\n                                        key={index}\r\n                                        className={`category-item ${filters.category === item.category ? 'active' : ''}`}\r\n                                        onClick={() => handleFilterChange('category', item.category)}\r\n                                    >\r\n                                        <div className=\"category-icon-title\">\r\n                                            <span\r\n                                                className=\"category-icon\"\r\n                                                style={{ backgroundColor: item.color }}\r\n                                            >\r\n                                                {item.icon}\r\n                                            </span>\r\n                                            <span className=\"category-title\">{item.category}</span>\r\n                                        </div>\r\n                                        <span\r\n                                            className=\"category-count\"\r\n                                            style={{ backgroundColor: item.color }}\r\n                                        >\r\n                                            {issues.filter(i => i.category === item.category).length}\r\n                                        </span>\r\n                                    </div>\r\n                                ))}\r\n                                <div\r\n                                    className={`category-item ${filters.category === 'All Categories' ? 'active' : ''}`}\r\n                                    onClick={() => handleFilterChange('category', 'All Categories')}\r\n                                >\r\n                                    <div className=\"category-icon-title\">\r\n                                        <span className=\"category-title\">All Categories</span>\r\n                                    </div>\r\n                                    <span className=\"category-count\">{issues.length}</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"sidebar-panel\">\r\n                            <div className=\"panel-header\">\r\n                                <Users size={20} className=\"panel-icon\" />\r\n                                <h4>Community Impact</h4>\r\n                            </div>\r\n                            <div className=\"impact-stats\">\r\n                                <div className=\"impact-stat-item\">\r\n                                    <div className=\"impact-icon\">âœ…</div>\r\n                                    <div className=\"impact-content\">\r\n                                        <strong>{communityImpact.issuesResolved}</strong>\r\n                                        <span>Issues Resolved</span>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"impact-stat-item\">\r\n                                    <div className=\"impact-icon\">âš¡</div>\r\n                                    <div className=\"impact-content\">\r\n                                        <strong>{communityImpact.responseTime}</strong>\r\n                                        <span>Avg Response Time</span>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"impact-stat-item\">\r\n                                    <div className=\"impact-icon\">â­</div>\r\n                                    <div className=\"impact-content\">\r\n                                        <strong>{communityImpact.communityScore}</strong>\r\n                                        <span>Community Score</span>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"browse-content\">\r\n                        <div className=\"content-panel filter-panel\">\r\n                            <div className=\"panel-header-main\">\r\n                                <div className=\"panel-title\">\r\n                                    <Filter size={24} className=\"title-icon\" />\r\n                                    <div>\r\n                                        <h3>Filter & Search Issues</h3>\r\n                                        <p>Find and engage with community concerns</p>\r\n                                    </div>\r\n                                </div>\r\n                                {(searchTerm || filters.category !== 'All Categories' || filters.status !== 'All Statuses') && (\r\n                                    <button onClick={clearFilters} className=\"clear-filters-btn\">\r\n                                        <span>Clear All</span>\r\n                                    </button>\r\n                                )}\r\n                            </div>\r\n\r\n                            <div className=\"search-section\">\r\n                                <div className=\"search-bar\">\r\n                                    <Search size={20} className=\"search-icon\" />\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        placeholder=\"Search issues by title, description, location...\"\r\n                                        value={searchTerm}\r\n                                        onChange={handleSearchChange}\r\n                                        className=\"search-input\"\r\n                                    />\r\n                                    {searchTerm && (\r\n                                        <button\r\n                                            className=\"clear-search-btn\"\r\n                                            onClick={() => setSearchTerm('')}\r\n                                        >\r\n                                            Ã—\r\n                                        </button>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"filter-controls\">\r\n                                <div className=\"filter-group\">\r\n                                    <label className=\"filter-label\">\r\n                                        <span className=\"filter-label-icon\">ðŸ“</span>\r\n                                        Category\r\n                                    </label>\r\n                                    <select\r\n                                        value={filters.category}\r\n                                        onChange={(e) => handleFilterChange('category', e.target.value)}\r\n                                        className=\"filter-select\"\r\n                                    >\r\n                                        {categories.map(category => (\r\n                                            <option key={category} value={category}>\r\n                                                {category}\r\n                                            </option>\r\n                                        ))}\r\n                                    </select>\r\n                                </div>\r\n\r\n                                <div className=\"filter-group\">\r\n                                    <label className=\"filter-label\">\r\n                                        <span className=\"filter-label-icon\">ðŸ”„</span>\r\n                                        Status\r\n                                    </label>\r\n                                    <select\r\n                                        value={filters.status}\r\n                                        onChange={(e) => handleFilterChange('status', e.target.value)}\r\n                                        className=\"filter-select\"\r\n                                    >\r\n                                        {statusOptions.map(status => (\r\n                                            <option key={status} value={status}>\r\n                                                {status}\r\n                                            </option>\r\n                                        ))}\r\n                                    </select>\r\n                                </div>\r\n\r\n                                <div className=\"filter-group\">\r\n                                    <label className=\"filter-label\">\r\n                                        <span className=\"filter-label-icon\">ðŸ“Š</span>\r\n                                        Sort By\r\n                                    </label>\r\n                                    <select\r\n                                        value={filters.sort}\r\n                                        onChange={(e) => handleFilterChange('sort', e.target.value)}\r\n                                        className=\"filter-select\"\r\n                                    >\r\n                                        {sortOptions.map(option => (\r\n                                            <option key={option} value={option}>\r\n                                                {option}\r\n                                            </option>\r\n                                        ))}\r\n                                    </select>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"results-info\">\r\n                                <div className=\"results-count\">\r\n                                    <strong>{filteredIssues.length}</strong>\r\n                                    <span>{filteredIssues.length === 1 ? ' issue' : ' issues'} found</span>\r\n                                </div>\r\n                                <div className=\"community-engagement\">\r\n                                    <div className=\"engagement-badge\">\r\n                                        <span className=\"engagement-dot\"></span>\r\n                                        High Community Engagement\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Issues List */}\r\n                        <div className=\"content-panel issues-panel\">\r\n                            <div className=\"panel-header-main\">\r\n                                <div className=\"panel-title\">\r\n                                    <FileText size={24} className=\"title-icon\" />\r\n                                    <div>\r\n                                        <h3>Community Issues</h3>\r\n                                        <p>Recent reports from your neighborhood</p>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"active-filters\">\r\n                                    {filters.category !== 'All Categories' && (\r\n                                        <span className=\"active-filter-tag\">Category: {filters.category}</span>\r\n                                    )}\r\n                                    {filters.status !== 'All Statuses' && (\r\n                                        <span className=\"active-filter-tag\">Status: {filters.status}</span>\r\n                                    )}\r\n                                    {filters.sort !== 'Newest First' && (\r\n                                        <span className=\"active-filter-tag\">Sorted by: {filters.sort}</span>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"issues-list-container\">\r\n                                {loading ? (\r\n                                    <div className=\"loading-state\">\r\n                                        <div className=\"loading-spinner\"></div>\r\n                                        <p>Loading community issues...</p>\r\n                                        <span className=\"loading-subtitle\">Fetching the latest reports from the server</span>\r\n                                    </div>\r\n                                ) : filteredIssues.length === 0 ? (\r\n                                    <div className=\"empty-state\">\r\n                                        <div className=\"empty-icon\">ðŸ”</div>\r\n                                        <h3>No issues found</h3>\r\n                                        <p>We couldn't find any issues matching your search criteria.</p>\r\n                                        <button onClick={clearFilters} className=\"clear-filters-btn large\">\r\n                                            Clear All Filters\r\n                                        </button>\r\n                                    </div>\r\n                                ) : (\r\n                                    <div className=\"issues-grid\">\r\n                                        {filteredIssues.map(issue => (\r\n                                            <div key={issue.id} className=\"issue-card\">\r\n                                                <div className=\"issue-header\">\r\n                                                    <div className=\"issue-meta-left\">\r\n                                                        <div\r\n                                                            className=\"issue-category-tag\"\r\n                                                            style={{\r\n                                                                backgroundColor: issueCategories.find(c => c.category === issue.category)?.color + '20',\r\n                                                                color: issueCategories.find(c => c.category === issue.category)?.color\r\n                                                            }}\r\n                                                        >\r\n                                                            {issue.category}\r\n                                                        </div>\r\n                                                        <div className={`priority-indicator priority-${issue.priority}`}>\r\n                                                            <div className={`priority-dot priority-${issue.priority}`}></div>\r\n                                                            {issue.priority} priority\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div className=\"issue-urgency\">\r\n                                                        {issue.urgency}\r\n                                                    </div>\r\n                                                </div>\r\n\r\n                                                <h4 className=\"issue-title\">{issue.title}</h4>\r\n                                                <p className=\"issue-description\">{issue.description}</p>\r\n\r\n                                                <div className=\"issue-meta\">\r\n                                                    <div className=\"meta-item\">\r\n                                                        <MapPin size={16} />\r\n                                                        <span>{issue.location}</span>\r\n                                                    </div>\r\n                                                    <div className=\"meta-item\">\r\n                                                        <Clock size={16} />\r\n                                                        <span>{getRelativeTime(issue.createdAt)}</span>\r\n                                                    </div>\r\n                                                </div>\r\n\r\n                                                <div className=\"issue-footer\">\r\n                                                    <div className=\"user-info\">\r\n                                                        <div className=\"user-avatar-small\">\r\n                                                            {issue.userAvatar}\r\n                                                        </div>\r\n                                                        <div className=\"user-details\">\r\n                                                            <span className=\"user-name\">{issue.user}</span>\r\n                                                            <span className=\"report-time\">{getRelativeTime(issue.createdAt)}</span>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n\r\n                                                <div className=\"issue-actions\">\r\n                                                    <div className=\"vote-section\">\r\n                                                        {/* Upvote */}\r\n                                                        <button\r\n                                                            className={`vote-btn upvote ${userVotes[issue.id] === 'upvote' ? 'voted' : ''}`}\r\n                                                            onClick={() => handleVote(issue.id, 'upvote')}\r\n                                                            // â­ FIX 2: Disable if already upvoted OR busy. This is the logic to stop re-voting the same type.\r\n                                                            disabled={userVotes[issue.id] === 'upvote' || busyVotes[issue.id]}\r\n                                                        >\r\n                                                            <Heart size={16} />\r\n                                                            <span>{issue.counts?.upvote || 0}</span>\r\n                                                        </button>\r\n                                                        {/* Downvote */}\r\n                                                        <button\r\n                                                            className={`vote-btn downvote ${userVotes[issue.id] === 'downvote' ? 'voted' : ''}`}\r\n                                                            onClick={() => handleVote(issue.id, 'downvote')}\r\n                                                            // â­ FIX 3: Disable if already downvoted OR busy.\r\n                                                            disabled={userVotes[issue.id] === 'downvote' || busyVotes[issue.id]}\r\n                                                        >\r\n                                                            <ThumbsDown size={16} />\r\n                                                            <span>{issue.counts?.downVote || 0}</span>\r\n                                                        </button>\r\n                                                    </div>\r\n\r\n                                                    <div className={`status-badge status-${issue.status.replace(' ', '').toLowerCase()}`}>\r\n                                                        {issue.status}\r\n                                                    </div>\r\n                                                </div>\r\n\r\n                                                {/* Comments toggle */}\r\n                                                <div className=\"comments-toggle\">\r\n                                                    <button className=\"comments-open-btn\" onClick={() => toggleComments(issue.id)}>\r\n                                                        <ChevronsDown size={14} /> {commentsOpen[issue.id] ? 'Hide' : 'Show'} Comments ({issue.comments || 0})\r\n                                                    </button>\r\n                                                </div>\r\n\r\n                                                {/* Comments panel */}\r\n                                                \r\n                                                {commentsOpen[issue.id] && (\r\n                                                    <div className=\"comments-panel\">\r\n                                                        {/* Add Comment */}\r\n                                                        <div className=\"add-comment\">\r\n                                                            <textarea\r\n                                                                placeholder=\"Write your comment...\"\r\n                                                                value={commentDrafts[issue.id] || ''}\r\n                                                                onChange={(e) => handleCommentChange(issue.id, e.target.value)}\r\n                                                                rows={2}\r\n                                                            />\r\n                                                            <div className=\"comment-actions\">\r\n                                                                <button onClick={() => postComment(issue.id)} disabled={busyComments[issue.id]}>\r\n                                                                    {busyComments[issue.id] ? 'Posting...' : 'Post Comment'}\r\n                                                                </button>\r\n                                                            </div>\r\n                                                        </div>\r\n\r\n                                                        {/* Comments List */}\r\n                                                        {(commentsStore[issue.id] || []).map(c => {\r\n                                                            // --- Use user name from populated userId object/temp object ---\r\n                                                            const commenterName = c.userId?.name || 'User';\r\n                                                            const isOwner = (c.userId?._id || c.userId) === user._id; \r\n                                                            const isEditing = editingComment?.commentId === c._id;\r\n\r\n                                                            return (\r\n                                                                <div key={c._id} className=\"comment-item\">\r\n                                                                    <div className=\"comment-avatar\">{commenterName[0].toUpperCase()}</div>\r\n                                                                    <div className=\"comment-body\">\r\n                                                                        {isEditing ? (\r\n                                                                            <div className=\"edit-comment-area\">\r\n                                                                                <textarea\r\n                                                                                    // Use the content from the editing state\r\n                                                                                    value={editingComment.content}\r\n                                                                                    onChange={(e) => setEditingComment(prev => ({ ...prev, content: e.target.value }))}\r\n                                                                                    rows={3}\r\n                                                                                />\r\n                                                                                <div className=\"comment-actions\">\r\n                                                                                    <button\r\n                                                                                        // Pass content from the editing state\r\n                                                                                        onClick={() => updateComment(issue.id, c._id, editingComment.content)}\r\n                                                                                        disabled={busyComments[c._id]}\r\n                                                                                    >\r\n                                                                                        <Save size={14} /> {busyComments[c._id] ? 'Saving...' : 'Save'}\r\n                                                                                    </button>\r\n                                                                                    <button className=\"cancel-edit-btn\" onClick={() => setEditingComment(null)}>Cancel</button>\r\n                                                                                </div>\r\n                                                                            </div>\r\n                                                                        ) : (\r\n                                                                            <>\r\n                                                                                <div className=\"comment-meta\">\r\n                                                                                    <span className=\"comment-author\">{commenterName}</span>\r\n                                                                                    <span className=\"comment-time\">\r\n                                                                                        {getRelativeTime(c.createdAt)} \r\n                                                                                        {/* Check if updatedAt is later than createdAt and looks like a valid date */}\r\n                                                                                        {c.updatedAt && c.updatedAt.toString() !== c.createdAt.toString() && new Date(c.updatedAt) > new Date(c.createdAt) ? ' (edited)' : ''}\r\n                                                                                    </span>\r\n                                                                                    {isOwner && (\r\n                                                                                        <div className=\"comment-owner-actions\">\r\n                                                                                            <button\r\n                                                                                                className=\"delete-comment-btn\"\r\n                                                                                                onClick={() => deleteComment(issue.id, c._id)}\r\n                                                                                            >\r\n                                                                                                ðŸ—‘ï¸\r\n                                                                                            </button>\r\n                                                                                        </div>\r\n                                                                                    )}\r\n                                                                                </div>\r\n                                                                                <div className=\"comment-content\">{c.content}</div>\r\n                                                                            </>\r\n                                                                        )}\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                            )\r\n                                                        })}\r\n                                                    </div>\r\n                                                )}\r\n\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <footer className=\"footer\">\r\n                <div className=\"footer-column footer-logo-section\">\r\n                    \r\n                    <p className=\"footer-tagline\">Civic Engagement Platform</p>\r\n                    <p>Empowering communities to report, track, and resolve civic issues through collaborative engagement between citizens and local authorities.</p>\r\n                </div>\r\n                <div className=\"footer-column\">\r\n                    <h4>Platform</h4>\r\n                    <ul>\r\n                        <li><a href=\"/\">How it Works</a></li>\r\n                        <li><a href=\"/\">Features</a></li>\r\n                        <li><a href=\"/\">Pricing</a></li>\r\n                        <li><a href=\"/\">Mobile App</a></li>\r\n                    </ul>\r\n                </div>\r\n                <div className=\"footer-column\">\r\n                    <h4>Support</h4>\r\n                    <ul>\r\n                        <li><a href=\"/\">Help Center</a></li>\r\n                        <li><a href=\"/\">Contact Us</a></li>\r\n                        <li><a href=\"/\">User Guide</a></li>\r\n                        <li><a href=\"/\">Community Forum</a></li>\r\n                    </ul>\r\n                </div>\r\n                <div className=\"footer-column\">\r\n                    <h4>Company</h4>\r\n                    <ul>\r\n                        <li><a href=\"/\">About Us</a></li>\r\n                        <li><a href=\"/\">Careers</a></li>\r\n                        <li><a href=\"/\">Press Kit</a></li>\r\n                        <li><a href=\"/\">Blog</a></li>\r\n                    </ul>\r\n                </div>\r\n            </footer>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default UserBrowseIssue;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}