{"ast":null,"code":"import React,{useEffect,useRef,useState}from'react';import L from'leaflet';import'leaflet/dist/leaflet.css';// Fix for default markers in Leaflet with Webpack\nimport{jsx as _jsx}from\"react/jsx-runtime\";delete L.Icon.Default.prototype._getIconUrl;L.Icon.Default.mergeOptions({iconRetinaUrl:'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png',iconUrl:'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png',shadowUrl:'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png'});const MapComponent=_ref=>{let{onLocationSelect,initialCenter}=_ref;const mapRef=useRef(null);const[map,setMap]=useState(null);const[marker,setMarker]=useState(null);// Default center (New York)\nconst defaultCenter=[40.7128,-74.0060];useEffect(()=>{// Initialize map\nconst leafletMap=L.map(mapRef.current).setView(initialCenter?[initialCenter.lat,initialCenter.lng]:defaultCenter,13);// Add OpenStreetMap tiles\nL.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',maxZoom:19}).addTo(leafletMap);// Add click event listener\nleafletMap.on('click',e=>{const{lat,lng}=e.latlng;// Remove existing marker\nif(marker){leafletMap.removeLayer(marker);}// Add new marker\nconst newMarker=L.marker([lat,lng],{draggable:true}).addTo(leafletMap);// Bind popup to marker\nnewMarker.bindPopup('Selected Location<br>Drag to adjust').openPopup();setMarker(newMarker);// Call the callback with coordinates\nif(onLocationSelect){onLocationSelect(lat,lng);}// Add drag end listener\nnewMarker.on('dragend',dragEvent=>{const newPosition=dragEvent.target.getLatLng();const newLat=newPosition.lat;const newLng=newPosition.lng;// Update popup content\nnewMarker.setPopupContent('Selected Location (Adjusted)<br>Drag to adjust');if(onLocationSelect){onLocationSelect(newLat,newLng);}});});// If initial center is provided, add a marker\nif(initialCenter){const initialMarker=L.marker([initialCenter.lat,initialCenter.lng],{draggable:true}).addTo(leafletMap);initialMarker.bindPopup('Current Location<br>Drag to adjust').openPopup();setMarker(initialMarker);// Add drag end listener for initial marker\ninitialMarker.on('dragend',dragEvent=>{const newPosition=dragEvent.target.getLatLng();const newLat=newPosition.lat;const newLng=newPosition.lng;initialMarker.setPopupContent('Selected Location (Adjusted)<br>Drag to adjust');if(onLocationSelect){onLocationSelect(newLat,newLng);}});}setMap(leafletMap);// Cleanup function\nreturn()=>{if(leafletMap){leafletMap.remove();}};},[onLocationSelect,initialCenter]);// Effect to update map center when initialCenter changes\nuseEffect(()=>{if(map&&initialCenter){map.setView([initialCenter.lat,initialCenter.lng],13);}},[map,initialCenter]);return/*#__PURE__*/_jsx(\"div\",{ref:mapRef,style:{width:'100%',height:'400px',borderRadius:'8px',border:'2px solid #e2e8f0'}});};export default MapComponent;","map":{"version":3,"names":["React","useEffect","useRef","useState","L","jsx","_jsx","Icon","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","iconUrl","shadowUrl","MapComponent","_ref","onLocationSelect","initialCenter","mapRef","map","setMap","marker","setMarker","defaultCenter","leafletMap","current","setView","lat","lng","tileLayer","attribution","maxZoom","addTo","on","e","latlng","removeLayer","newMarker","draggable","bindPopup","openPopup","dragEvent","newPosition","target","getLatLng","newLat","newLng","setPopupContent","initialMarker","remove","ref","style","width","height","borderRadius","border"],"sources":["C:/Users/saksh/OneDrive/Desktop/DS/civiceye/civiceye/frontend/src/pages/MapComponent.jsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\nimport L from 'leaflet';\r\nimport 'leaflet/dist/leaflet.css';\r\n\r\n// Fix for default markers in Leaflet with Webpack\r\ndelete L.Icon.Default.prototype._getIconUrl;\r\nL.Icon.Default.mergeOptions({\r\n  iconRetinaUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png',\r\n  iconUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png',\r\n  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png',\r\n});\r\n\r\nconst MapComponent = ({ onLocationSelect, initialCenter }) => {\r\n    const mapRef = useRef(null);\r\n    const [map, setMap] = useState(null);\r\n    const [marker, setMarker] = useState(null);\r\n\r\n    // Default center (New York)\r\n    const defaultCenter = [40.7128, -74.0060];\r\n\r\n    useEffect(() => {\r\n        // Initialize map\r\n        const leafletMap = L.map(mapRef.current).setView(\r\n            initialCenter ? [initialCenter.lat, initialCenter.lng] : defaultCenter,\r\n            13\r\n        );\r\n\r\n        // Add OpenStreetMap tiles\r\n        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n            attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\r\n            maxZoom: 19,\r\n        }).addTo(leafletMap);\r\n\r\n        // Add click event listener\r\n        leafletMap.on('click', (e) => {\r\n            const { lat, lng } = e.latlng;\r\n\r\n            // Remove existing marker\r\n            if (marker) {\r\n                leafletMap.removeLayer(marker);\r\n            }\r\n\r\n            // Add new marker\r\n            const newMarker = L.marker([lat, lng], {\r\n                draggable: true,\r\n            }).addTo(leafletMap);\r\n\r\n            // Bind popup to marker\r\n            newMarker.bindPopup('Selected Location<br>Drag to adjust').openPopup();\r\n\r\n            setMarker(newMarker);\r\n\r\n            // Call the callback with coordinates\r\n            if (onLocationSelect) {\r\n                onLocationSelect(lat, lng);\r\n            }\r\n\r\n            // Add drag end listener\r\n            newMarker.on('dragend', (dragEvent) => {\r\n                const newPosition = dragEvent.target.getLatLng();\r\n                const newLat = newPosition.lat;\r\n                const newLng = newPosition.lng;\r\n                \r\n                // Update popup content\r\n                newMarker.setPopupContent('Selected Location (Adjusted)<br>Drag to adjust');\r\n                \r\n                if (onLocationSelect) {\r\n                    onLocationSelect(newLat, newLng);\r\n                }\r\n            });\r\n        });\r\n\r\n        // If initial center is provided, add a marker\r\n        if (initialCenter) {\r\n            const initialMarker = L.marker([initialCenter.lat, initialCenter.lng], {\r\n                draggable: true,\r\n            }).addTo(leafletMap);\r\n            \r\n            initialMarker.bindPopup('Current Location<br>Drag to adjust').openPopup();\r\n            setMarker(initialMarker);\r\n\r\n            // Add drag end listener for initial marker\r\n            initialMarker.on('dragend', (dragEvent) => {\r\n                const newPosition = dragEvent.target.getLatLng();\r\n                const newLat = newPosition.lat;\r\n                const newLng = newPosition.lng;\r\n                \r\n                initialMarker.setPopupContent('Selected Location (Adjusted)<br>Drag to adjust');\r\n                \r\n                if (onLocationSelect) {\r\n                    onLocationSelect(newLat, newLng);\r\n                }\r\n            });\r\n        }\r\n\r\n        setMap(leafletMap);\r\n\r\n        // Cleanup function\r\n        return () => {\r\n            if (leafletMap) {\r\n                leafletMap.remove();\r\n            }\r\n        };\r\n    }, [onLocationSelect, initialCenter]);\r\n\r\n    // Effect to update map center when initialCenter changes\r\n    useEffect(() => {\r\n        if (map && initialCenter) {\r\n            map.setView([initialCenter.lat, initialCenter.lng], 13);\r\n        }\r\n    }, [map, initialCenter]);\r\n\r\n    return (\r\n        <div \r\n            ref={mapRef} \r\n            style={{ \r\n                width: '100%', \r\n                height: '400px', \r\n                borderRadius: '8px',\r\n                border: '2px solid #e2e8f0'\r\n            }} \r\n        />\r\n    );\r\n};\r\n\r\nexport default MapComponent;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}